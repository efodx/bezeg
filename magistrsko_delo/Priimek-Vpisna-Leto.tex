%\documentclass[mat2, tisk]{fmfdelo}
% \documentclass[fin2, tisk]{fmfdelo}
\documentclass[isrm2, tisk]{fmfdelo}


\usepackage[caption = false]{subfig}


% - ime datoteke z viri (vključno s končnico .bib), če uporabljate BibTeX


% \documentclass[ped, tisk]{fmfdelo}
% Če pobrišete možnost tisk, bodo povezave obarvane,
% na začetku pa ne bo praznih strani po naslovu, …

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% METAPODATKI
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% - vaše ime
\avtor{Kevin Štampar}

% - naslov dela v slovenščini
\naslov{Orodje za grafični prikaz konceptov Bezierjevih in PH krivulj}

% - naslov dela v angleščini
\title{Tool for graphically displaying concepts of Bezier and PH curves}

% - ime mentorja/mentorice s polnim nazivom:
%   - doc.~dr.~Ime Priimek
%   - izr.~prof.~dr.~Ime Priimek
%   - prof.~dr.~Ime Priimek
%   za druge variante uporabite ustrezne ukaze
\mentor{prof.~dr.~Emil Žagar}
% \somentor{...}
% \mentorica{...}
% \somentorica{...}
% \mentorja{...}{...}
% \somentorja{...}{...}
% \mentorici{...}{...}
% \somentorici{...}{...}

% - leto magisterija
\letnica{2024}

% - povzetek v slovenščini
%   V povzetku na kratko opišite vsebinske rezultate dela. Sem ne sodi razlaga
%   organizacije dela, torej v katerem razdelku je kaj, pač pa le opis vsebine.
\povzetek{Tukaj napišemo povzetek vsebine. Sem sodi razlaga vsebine in ne opis tega, kako je delo organizirano.}

% - povzetek v angleščini
\abstract{An abstract of the work is written here. This includes a short description of
the content and not the structure of your work.}

% - klasifikacijske oznake, ločene z vejicami
%   Oznake, ki opisujejo področje dela, so dostopne na strani https://www.ams.org/msc/
\klasifikacija{74B05, 65N99}

% - ključne besede, ki nastopajo v delu, ločene s \sep
\kljucnebesede{integracija\sep kompleks}

% - angleški prevod ključnih besed
\keywords{integration\sep complex} % angleški prevod ključnih besed

% - neobvezna zahvala
\zahvala{
    Zahvaljujem se mentorju za zelo sproščen odnos!
}

% - program dela, ki ga napiše mentor z osnovno literaturo
\programdela{
    Mentor naj napiše program dela skupaj z osnovno literaturo.
}

\osnovnaliteratura{
% Literatura mora biti tukaj posebej samostojno navedena (po pomembnosti) in ne
% le citirana. V tem razdelku literature ne oštevilčimo po svoje, ampak uporabljamo
% ukaz \vnosliterature, v katerega vpišemo citat
    \vnosliterature{24ac2b10-13c2-3e17-bc91-5f7366bf076c}
}

% - ime datoteke z viri (vključno s končnico .bib), če uporabljate BibTeX
\literatura{literatura.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DODATNE DEFINICIJE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% naložite dodatne pakete, ki jih potrebujete
\usepackage{units}        % fizikalne enote kot \unit[12]{kg} s polovico nedeljivega presledka, glej primer v kodi
\usepackage{graphicx}     % za slike
% \usepackage{tikz}
% VEČ ZANIMIVIH PAKETOV
% \usepackage{array}      % več možnosti za tabele
% \usepackage[list=true,listformat=simple]{subcaption}  % več kot ena slika na figure, omogoči slika 1a, slika 1b
% \usepackage[all]{xy}    % diagrami
% \usepackage{doi}        % za clickable DOI entrye v bibliografiji
\usepackage{enumitem}     % več možnosti za sezname

% Za barvanje source kode
% \usepackage{minted}
% \renewcommand\listingscaption{Program}

% Za pisanje psevdokode
\usepackage{algpseudocode}  % za psevdokodo
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{mathtools}
\usepackage{hyperref}
\usepackage{graphics}
\floatname{algorithm}{Algoritem}
\renewcommand{\listalgorithmname}{Kazalo algoritmov}

% deklarirajte vse matematične operatorje, da jih bo LaTeX pravilno stavil
% \DeclareMathOperator{\...}{...}

% vstavite svoje definicije ...
\newcommand{\R}{\mathbb R}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
% Lahko se zgodi, da je ukaz \C definiral že paket hyperref,
% zato dobite napako: Command \C already defined.
% V tem primeru namesto ukaza \newcommand uporabite \renewcommand
\newcommand{\C}{\mathbb C}
\newcommand{\Q}{\mathbb Q}
\newcommand{\Pn}{\mathbb P_n}
\newcommand{\p}{\mathbf{p}}
\newcommand{\B}{\mathbf{B}}


%Bernstein
\newcommand{\bernsteinbase}[3]{\binom{#1}{#2}t^{#1}(1-t)^{#2}}
\newcommand{\bernstein}[2]{\binom{#1}{#2}t^{#2}(1-t)^{#1-#2}}
\newcommand{\lilb}[2]{B_{#1}^{#2}(t)}
\newcommand{\bigb}[1]{B_{#1}(t)}
\newcommand{\bigbb}[1]{\textbf{B}_{#1}(t)}
\newcommand{\bigbbod}[2]{\textbf{B}_{#1}(#2)}
\newcommand{\bigbbt}{\textbf{B}(t)}
\newcommand{\bigbo}[1]{B'_{#1}(t)}
\newcommand{\bernsteinsum}[2]{\sum_{#1=0}^{#2} \beta_{#1}\lilb{#1}{#2}}
\newcommand{\bernsteinsump}[2]{\sum_{#1=0}^{#2} \p_{#1}\lilb{#1}{#2}}
\newcommand{\bernsteinsumtri}[3]{\sum_{#1=0}^{#2} #3_{#1}\lilb{#1}{#2}}
\newcommand{\bernsteinsumtritri}[3]{\sum_{#1=0}^{#2} #3\lilb{#1}{#2}}
\newcommand{\bernsteinsumtridva}[2]{\sum_{#1=0}^{#2} \lilb{#1}{#2}}

\newcommand{\bsum}{\bernsteinsum{i}{n}}

% Komentarji znotraj vsebine
\newcommand{\mycomment}[1]{\textbf{\textcolor{red}{#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ZAČETEK VSEBINE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

    \section{Uvod}
    Napišite kratek zgodovinski in matematični uvod. Pojasnite motivacijo za problem, kje
    nastopa, kje vse je bil obravnavan. Na koncu opišite tudi organizacijo dela -- kaj je v
    katerem razdelku.


    \mycomment{Ker je v okviru magistrskega dela nastalo orodje za grafični prikaz konceptov, bo delo polno s slikovnimi primeri.}

    \newpage


    \section{Bezierjeve krivulje}\label{sec:bezierjeve-krivulje}

    \subsection{Bernsteinovi bazni polinomi}\label{subsec:bernsteinovi-polinomi}
    V tem podrazdelku bomo predstavili Bernsteinove bazne polinome in nekaj njihovih lastnosti, ki bodo ključne pri upeljavi Bezierjevih krivulj.
    Začnimo z njihovo definicijo.
    \begin{definicija}
        \label{def:bernstein}
        Za nenegativna cela števila $n$ je $i$-ti \textit{Bernsteinov bazni polinom} podan s predpisom \[B_i^n(t)\coloneqq\bernstein{n}{i}.\]
    \end{definicija}
    % V definiciji Bernsteinovega polinoma smo uporabili le bazne polinome z indeksi $i=0,\ldots,n$.
    Iz definicije je očitno, da so za indekse $i>n$, oziroma $i<0$, Bernsteinovi bazni polinomi ničelni.
    Pri določeni stopnji $n$ je neničelnih Bernsteinovih baznih polinomov torej $n+1$.
    Brez dokaza povejmo, da so linearno neodvisni in zato tvorijo bazo prostora $\mathbb{P}_n$.
    Takšni bazi pravimo \textit{Bernsteinova baza}, polinomu izraženemu v njej pa pravimo \textit{Bernsteinov polinom}.
    \begin{primer}
        \label{primer:bernsteinovi}
        Za primer si bomo ogledali Bernsteinove bazne polinome stopenj $n=0,1,2,3$.
        Pri stopnji $0$ imamo konstantni polinom s funkcijskim predpisom $B_{0}^{0}(t) = 1$.
        Za stopnjo $1$ dobimo polinoma s funkcijskimi predpisi $B_{0}^{1}(t) = 1-t$ in $B_{1}^{1}(t) = t$, ki sta znana iz linearne interpolacije dveh točk.
        Funkcijski predpisi kvadratnih in kubičnih Bernsteinovih baznih polinomov pa so naslednji
        \begin{align*}
            &B_{0}^{2}(t) = (1-t)^2,\quad B_{1}^{2}(t) = 2t(1-t),\quad B_{2}^{2}(t) = t^2,  \\
            &B_{0}^{3}(t) = (1-t)^3,\quad B_{1}^{3}(t) = 3t(1-t)^2,\quad B_{2}^{2}(t) = 3t^2(1-t),\quad B_{3}^{3}(t) = t^3.
        \end{align*}
        Grafe polinomov iz primera si lahko ogledamo na sliki~\ref{fig:bernstein-base}.
    \end{primer}
    \begin{figure}[h!]
        \captionsetup[subfigure]{labelformat=empty}
        \centering
        \subfloat[$n=0$]{\includegraphics[width = 0.45\textwidth]{images/bernstein-0}}
        \qquad
        \subfloat[$n=1$]{\includegraphics[width = 0.45\textwidth]{images/bernstein-1}} \\
        \subfloat[$n=2$]{\includegraphics[width = 0.45\textwidth]{images/bernstein-2}}
        \qquad
        \subfloat[$n=3$]{\includegraphics[width = 0.45\textwidth]{images/bernstein-3}}
        \caption{Bernsteinovi bazni polinomi stopenj $n=0,1,2,3$.}
        \label{fig:bernstein-base}
    \end{figure}
    Brez dokaza v naslednjem izreku naštejmo nekaj osnovnih lastnosti Bernsteinovih baznih polinomov.
    \begin{izrek}
        Za Bernsteinove bazne polinome $B_i^n$ velja naslednje.
        \label{izrek:bernsteinovi_lastnosti}
        \begin{enumerate}
            \item So nenegativni na intervalu $[0,1]$.\label{izrek:bernsteinovi_lastnosti:pozitivnost} \label{izrek:bernsteinovi_lastnosti:pozitivnost}
            \item $B_i^n(0) = \delta_{i,0}$ in $B_i^n(1) = \delta_{i,n}$, kjer je $\delta_{i,j} = \begin{cases}
                                                                                                      1 & i=j \\
                                                                                                      0 & 1\neq j
            \end{cases}.$
            \item So simetrični, tj.\ $B_i^n(1-t) = B^n_{n-i}(t)$, $\forall t\in\R$. \label{izrek:bernsteinovi_lastnosti:simetrija}
            \item So razčlenitev enote, tj.\  $\sum_{i=0}^{n}B_{i}^{n}(t) = 1$, $\forall t\in\R$.\label{izrek:bernsteinovi_lastnosti:enota}
        \end{enumerate}
    \end{izrek}
%    \begin{dokaz}
%        Lastnost (1) očitno izhaja iz lastnosti binomskega simbola, lastnost (2) pa iz definicije.
%        Dokažimo simetričnost in razčlenitev enote.\\
%        \noindent(3) Namesto spremenljivke $t$ v enačbo za bernsteinov bazni polinom $B_i^n(t)$ vstavimo izraz $1-t$ in uporabimo lastnost binomskega simbola $\binom{n}{i} = \binom{n}{n-i}$, dobimo
%        \[B_i^n(1-t) = \binom{n}{i}(1-t)^i(1-(1-t))^{n-i} =  \binom{n}{n-i}(1-t)^it^{n-i} = B^{n-i}_{i}(t).\]
%        \noindent(5) Za $1 = 1^n = (1-t+t)^n = ((1-t) + t)^n$ uporabimo binomski izrek, dobimo
%        \[\left((1-t) + t\right)^n = \sum_{i=0}^{n}\bernstein{n}{i} = \sum_{i=0}^n B_i^n(t).\]
%    \end{dokaz}
    Prve tri lastnosti iz izreka lahko opazimo na že prej ogledani sliki~\ref{fig:bernstein-base}.
    Četrto lastnost pa je moč opaziti na sliki~\ref{fig:bernstein-base-sum}, kjer so prikazani naloženi ploščinski grafikoni Bernsteinovih baznih polinomov. % za stopnje $n=0,1,2,3$.
    Količina barve pri določenem parametru $t\in[0,1]$ pove, koliko pripadajoč polinom $B_i^n$ prispeva k razčlenitvi enote.
    \begin{figure}[h]
        \captionsetup[subfigure]{labelformat=empty}
        \centering
        \subfloat[$n=0$]{\includegraphics[width = 0.45\textwidth]{images/bernstein-sum-0}}
        \qquad
        \subfloat[$n=1$]{\includegraphics[width = 0.45\textwidth]{images/bernstein-sum-1}} \\
        \subfloat[$n=2$]{\includegraphics[width = 0.45\textwidth]{images/bernstein-sum-2}}
        \qquad
        \subfloat[$n=3$]{\includegraphics[width = 0.45\textwidth]{images/bernstein-sum-3}}
        \caption{Naloženi ploščinski grafikoni Bernsteinovih baznih polinomov.}
        \label{fig:bernstein-base-sum}
    \end{figure}

    S sledečim izrekom podamo rekurzivno zvezo za računanje vrednosti Bernsteinovih baznih polinomov.
    \begin{izrek}
        \label{izrek:bernsteinovi_lastnosti:rekruzija}
        Za Bernsteinove bazne polinome stopnje $n>0$ velja rekurzivna zveza
        \[B_i^n(t) = (1-t)B_i^{n-1}(t) + tB_{i-1}^{n-1}(t),\ \forall t\in\R.\]
    \end{izrek}
    Izrek je enostavno dokazati s pomočjo indukcije, zato bomo dokaz izpustili.
%    Rekurzivno zvezo dokažimo z indukcijo.
%    \begin{dokaz}
%        Za $n=1$ zveza drži, saj iz nje dobimo $B_i^1(t) = (1-t)B_i^{0}(t) + tB_{i-1}^{0}(t)$ oziroma $B_0^1(t) = (1-t)$ in $B_1^1(t) = t$.
%        Za indukcijski korak pa desni del rekurzivne zveze manipuliramo, da pridemo do levega
%        \begin{align*}
%        (1-t)
%            B_i^{n-1}(t) + tB_{i-1}^{n-1}(t) &= \binom{n-1}{i}t^{i}(1-t)^{n-i} + \binom{n-1}{i-1}t^{i}(1-t)^{n-i}  \\
%            &\stackrel{(1)}{=} \binom{n}{i}t^{i}(1-t)^{n-i} = B_i^n(t),
%        \end{align*}
%        kjer smo pri enakosti (1) uporabili lastnost binomskega simbola $\binom{n-1}{i} + \binom{n-1}{i-1} = \binom{n}{i}.$
%    \end{dokaz}
    V kasnejših razdelkih bomo potrebovali tudi odvode Bernsteinovih baznih polinomov.
    Ker Bernsteinovi bazni polinomi stopnje $n$ tvorijo bazo prostora $\mathbb{P}_n$, lahko njihove odvode izrazimo v Bernsteinovi bazi stopnje $n-1$.
    Z nekaj računanja bi prišli do sledečega rezultata.
    \begin{izrek}
        Za odvode Bernsteinovih baznih polinomov velja zveza
        \[B_{i}^{n\prime}=n(B_{i-1}^{n-1} - B_{i}^{n-1}).\]
    \end{izrek}
%    \begin{dokaz}
%        Bernsteinov bazni polinom najprej odvajamo da dobimo
%        \begin{align*}
%            B_{i}^{n\prime}(t) &=\binom{n}{i}\left(it^{i-1}(1-t)^{n-i} - (n-i) t^i(1-t)^{n-i-1} \right) \\
%            &=\binom{n}{i}it^{i-1}(1-t)^{n-i} - \binom{n}{i}(n-i) t^i(1-t)^{n-i-1}.
%        \end{align*}
%        Nato v zgornje vstavimo binomski zvezi $\binom{n}{i}i = \frac{n!i}{(n-i)i!} =  \frac{n(n-1)!}{(n-i)(i-1)!} = n\binom{n-1}{i-1}$ in $\binom{n}{i}(n-i) = \frac{n!(n-i)}{(n-i)!}  = \frac{n(n-1)!}{(n-i-1)!} =n\binom{n-1}{i}$ in dobimo željeno.
%    \end{dokaz}
    Za konec podrazdelka izpeljimo še formulo za zmnožek dveh Bernsteinovih polinomov.
    \begin{izrek}
        Naj bosta $f$ in $g$ Bernsteinova polinoma s funkcijskimi predpisi $f(t)=\sum_{i=0}^{m}\alpha_iB_i^m(t)$ in $g(t)=\sum_{i=0}^{n}\beta_iB_i^n(t)$.
        Potem za njun zmnožek velja
        \[ f(t)g(t) = \sum_{i=0}^{m+n}\left(\sum_{j=\max(0,i-n)}^{\min(m,i)} \frac{\binom{m}{j}\binom{n}{i-j}}{\binom{m+n}{i}} \alpha_i\beta_{i-j} \right)B_{i}^{m+n}(t).\]
    \end{izrek}
    \begin{dokaz}
        Naj bosta $f$ in $g$ Bernsteinova polinoma iz izreka.
        Polinoma zmnožimo, da dobimo sledeče
        \[f(t)g(t) =\sum_{i=0}^{m}\alpha_iB_{i}^{m}(t)\sum_{j=0}^{n}\beta_jB_{j}^{n}(t) = \sum_{i=0}^{m+n}\sum_{l=0}^i \alpha_lB_{l}^{m}(t)\beta_{i-l}B_{i-l}^{n}(t). \]
        V izraz vstavimo predpise Bernsteinovih baznih polinomov in ga poenostavimo.
        Od tod sledi
        %&= \sum_{i=0}^{m+n}\sum_{l=0}^i \alpha_l \binom{m}{l}t^{l}(1-t)^{m-l} \beta_{i-l} \binom{n}{i-l}t^{i-l}(1-t)^{n-i+l} \\
        \[\sum_{i=0}^{m+n}\sum_{l=0}^i \alpha_l \beta_{i-l} \binom{m}{l}\binom{n}{i-l}t^{i}(1-t)^{m+n-i}\]
        Kar lahko z izpostavitvijo binoma $\binom{m+n}{i}$ predstavimo v Bernsteinovi bazi kot
        \[\sum_{i=0}^{m+n} \left(\sum_{l=0}^i  \alpha_l \beta_{i-l}\frac{\binom{m}{l}\binom{n}{i-l}}{\binom{m+n}{i}}\right) \binom{m+n}{i} t^{i}(1-t)^{m+n-i}.\]
        V primerih, ko velja $l>m$ ali $i-l>n$ imamo v števcu ulomka $0$, kar privede do zapisa iz izreka.
    \end{dokaz}

    \subsection{Večdimenzionalne oznake}
    Da bodo zapisi v sledečih razdelkih bolj pregledni, bomo uvedli večdimenzionalne oznake.
    Večdimenzionalnost bomo ponazarjali z odebelitvijo črke.
    Tako bomo večdimenzionalnost točke $x\in\R^{n+1}$ označili z $\mathbf{x}=(x_0,x_1,\dots,x_n)$, večdimenzionalnost funkcije $f:\R\to\R^{n+1}$ pa z $\mathbf{f}=\left( f_0,f_1,\dots,f_n\right)$.

    \subsection{Bezierjeve krivulje}
    Če v Bernsteinov polinom namesto skalarjev vstavimo točke, dobimo predpis parametrizacije Bezierjeve krivulje.
    Povedano formaliziramo z naslednjo definicijo.
    \begin{definicija}
        Bezierjeva krivulja $\mathbf{B}_n: [0,1]\to \R^d$ stopnje $n\in\N$ in dimenzije $d\in\N$, za  $d>1$, je polinomska krivulja podana s točkami $\p_i\in\R^d$, za $i=0,1,\ldots,n$, in parametrizacijo
        \[\bigbb{n}=\bernsteinsump{i}{n}.\]
        Točkam $\p_i$ pravimo \textit{kontrolne točke}.
        Če zaporedne kontrolne točke povežemo, pa dobimo \textit{kontrolni poligon}.
    \end{definicija}
    \begin{opomba}
        \label{opomba:dim-0}
        Kjer je potrebno, lahko definicijo razširimo tudi na stopnjo $n=0$.
        Iz zgornje parametrizacije potem sledi $\mathbf{B}_0(t)=\p_0$.
    \end{opomba}
    \begin{opomba}
        Pri slikovnem gradivu iz dela se bomo omejili na prostor dimenzije $d=2$, torej na Bezierjeve krivulje v ravnini.
    \end{opomba}
    Na sliki~\ref{fig:bezierjeva-krivulja} si lahko ogledamo primere Bezierjevih krivulj stopenj $n=1,2,3,4$ s pripadajočimi kontrolnimi poligoni.
    \begin{figure}[ht!]
        \captionsetup[subfigure]{labelformat=empty}
        \centering
        \subfloat[$n=1$]{\includegraphics[width = 0.45\textwidth]{images/bezier-curve-1}}
        \qquad
        \subfloat[$n=2$]{\includegraphics[width = 0.45\textwidth]{images/bezier-curve-2-control}} \\
        \subfloat[$n=3$]{\includegraphics[width = 0.45\textwidth]{images/bezier-curve-3-control}}
        \qquad
        \subfloat[$n=4$]{\includegraphics[width = 0.45\textwidth]{images/bezier-curve-4-control}}
        \caption{Bezierjeve krivulje s pripadajočimi kontrolnimi poligoni za stopnje $n=1,2,3,4$.}
        \label{fig:bezierjeva-krivulja}
    \end{figure}
    Zapišimo sedaj nekaj osnovnih lastnosti Bezierjevih krivulj.
    \begin{izrek}{Bezierjeva krivulja $\mathbf{B}_n$ s kontrolnimi točkami $\p_i$, za $i=0,1\ldots,n$, ima sledeče lastnosti.}
        \label{izrek:lastnosti-bezierjevih-krivulj}
        \begin{enumerate}
            \item Interpolira končne točke, t.j\ velja $\bigbbod{n}{0}=\p_0$ in $\bigbbod{n}{1}=\p_n$.
            \item Je afino invariantna, t.j\ za poljubno afino transformacijo $\varphi$ velja \[\varphi \left(\bernsteinsump{i}{n}\right) =\bernsteinsumtritri{i}{n}{\varphi(\p_i)}.\]
            \item Leži znotraj konveksne ovojnice svojih kontrolnih točk.
        \end{enumerate}
    \end{izrek}
    Dokazi lastnosti so enostavni, zato jih izpustimo.
    Preden si lastnosti ogledamo na slikah, povejmo zakaj so pomembne za CAGD sisteme.
    Interpolacija končnih točk uporabniku omogoča kontrolo nad tem, kje bo krivuljo začel in kje zaključil.
    Zaradi Afine invariance lahko uporabnikove transformacije krivulje v ozadju CAGD sistema prevedemo v transformacije kontrolnih točk.
    Tretja lastnost pa uporabniku s kontrolnimi točkami omogoča upravljanje krivulje, kjer je krivulja zmerom v bližini svojih kontrolnih točk.
    Lastnosti si sedaj oglejmo na slikah.
    Interpolacijo končnih točk je bilo moč videti že na sliki~\ref{fig:bezierjeva-krivulja}.
    Posledice afine invariance si lahko ogledamo na sliki~\ref{fig:bezier-affine-transform}.
    Na sliki~\ref{fig:bezier-convex-hull} pa si lahko ogledamo konveksni ovojnici kontrolnih točk dveh Bezierjevih krivulj.
    Vidimo lahko, da krivulji ležita znotraj njih.
    \begin{figure}[ht!]
        \captionsetup[subfigure]{labelformat=empty}
        \centering
        \subfloat[Začetna krivulja]{\includegraphics[width = 0.45\textwidth]{images/afine-transform-start}}
        \qquad
        \subfloat[Povečanje]{\includegraphics[width = 0.45\textwidth]{images/afine-transform-bigger}} \\
        \subfloat[Zrcaljenje čez $x$ os]{\includegraphics[width = 0.45\textwidth]{images/afine-transform-flip}}
        \qquad
        \subfloat[Rotiranje za $\frac{\pi}{2}$]{\includegraphics[width = 0.45\textwidth]{images/afine-transform-rotate}}
        \caption{Afine transformacije Bezierjeve krivulje.}
        \label{fig:bezier-affine-transform}
    \end{figure}
    \begin{figure}[ht!]
        \captionsetup[subfigure]{labelformat=empty}
        \centering
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/bezier-curve-convex-hull-1}}
        \qquad
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/bezier-curve-convex-hull-2}}
        \caption{Konveksni ovojnici kontrolnih točk Bezierjevih krivulj.}
        \label{fig:bezier-convex-hull}
    \end{figure}

%    Izrek~\ref{izrek:lastnosti-bezierjevih-krivulj} sedaj tudi dokažimo.
%    \begin{dokaz}
%        \noindent Lastnost (1) dokažemo s pomočjo izreka~\ref{izrek:bernsteinovi_lastnosti}.
%        Iz njega sledi
%        \[ \bigbbod{n}{0}=\sum_{i=0}^{n}\p_{i}B_i^n(t)(0) = \sum_{i=0}^{n}\p_{i}\delta_{0,i} = \p_0.\]%,\ \text{in} \ \bigbbod{n}{1}=\sum_{i=0}^{n}\p_{i}B_i^n(t)(1) = \sum_{i=0}^{n}\p_{i}\delta_{n,i} = \p_n\]
%        Podobno lahko naredimo tudi za $\bigbbod{n}{1}.$
%        Dokažimo sedaj lastnost (2).
%        Naj bo $\varphi$ afina preslikava.
%        Zanjo torej velja $\varphi(x) = A\mathbf{x} + \mathbf{b}$.
%        Potem za afino transformacijo Bezierjeve krivulje velja
%        \begin{align*}
%            \varphi\left(\sum_{i=0}^{n}\p_{i}B_i^n(t)(t)\right) &= A\left(\sum_{i=0}^{n}\p_{i}B_i^n(t)(t)\right) + \mathbf{b} &&=  \sum_{i=0}^{n}A\p_{i}B_i^n(t)(t) + \mathbf{b}  \\
%            &= \sum_{i=0}^{n}A\p_{i}B_i^n(t)(t) + \sum_{i=0}^{n}\mathbf{b}B_i^n(t)(t) &&= \sum_{i=0}^{n}(A\p_{i}+\mathbf{b})B_i^n(t)(t) \\
%            &= \bernsteinsumtritri{i}{n}{\varphi(\p_i).}
%        \end{align*}
%        Kar smo tudi želeli dokazati.
%        Za lastnost (3) posežemo po definiciji konveksne ovojnice.
%        Konveksna ovojnica kontrolnih točk Bezierjeve krivulje je množica vseh konveksnih kombinacij teh točk, tj.\ $\sum_{i=0}^{n}\lambda_i\p_{i}$, kjer so $\lambda_i$ nenegativna realna števila za katere velja $\lambda_0 + \lambda_1 + \dots + \lambda_n = 1$.
%        Ker so Bernsteinovi polinomi razčlenitev enote in nenegativni na intervalu $[0,1]$, lahko zapišemo $\lambda_i=B_i^n(t)$.
%    \end{dokaz}

    \subsection{Decasteljaujev algoritem}
    Stabilnost metod je v CAD in CAGD sistemih bistvene narave.
    Direktno računanje vrednosti Bernsteinovih polinomov preko enačb iz definicije~\ref{def:bernstein} pa ni stabilno~\cite{placeholder}.
    Da lahko točke Bezierjevih krivulj računamo stabilno, potrebujemo sledeč izrek.
    \begin{izrek}
        \label{izrek:decastelaju-rekurzija}
        Označimo z $\bigbbt_{[\p_0,\p_1,\dots,\p_n]}$ parametrizacijo Bezierjeve krivulje s kontrolnimi točkami $\p_0,\p_1,\dots,\p_n$.
        Potem za poljubno realno število $t$ in naravno število $n$ velja rekurzivna zveza \[\bigbbt_{[\p_0,\p_1,\dots,\p_n]} = (1-t)\bigbbt_{[\p_0,\p_1,\dots,\p_{n-1}]} +t\bigbbt_{[\p_1,\p_2,\dots,\p_n]}.\]
    \end{izrek}
    Izrek s pomočjo indukcije tudi dokažimo.
    \begin{dokaz}
        Za $n=1$ zveza drži, saj iz nje dobimo  \[\bigbbt_{[\p_0,\p_1]} = (1-t)\bigbbt_{[\p_0]} +t\bigbbt_{[\p_1]} = (1-t)\p_2 +t\p_1.\]
        Indukcijski korak pa dokažemo tako, da v desni del rekurzivne zveze iz izreka vstavimo parametrizaciji Bezierjevih krivulj in dobimo
        \[ (1-t) \bigbbt_{[\p_0,\p_1,\dots,\p_{n-1}]}+t\bigbbt_{[\p_1,\p_2,\dots,\p_n]} = (1-t)\bernsteinsump{i}{n-1}+t\sum_{i=0}^{n-1} \p_{i+1}B_i^{n-1}(t).\]
        Nato zamaknemo indeks desne vsote in skupne točke postavimo pod eno vsoto.
        Od tod sledi
        \begin{align*}
            &(1-t)\bernsteinsump{i}{n-1}+ t\sum_{i=1}^{n} \p_{i}B_{i-1}^{n-1}(t) \\
            %  &= \p_0(1-t)B_{0}^{n-1}(t) + \sum_{i=1}^{n-1}\p_{i}(1-t)B_i^{n-1}(t) +  \sum_{i=1}^{n-1} \p_{i}tB_{i-1}^{n-1}(t) + \p_n B_{n-1}^{n-1}(t) \\
            &= \p_0(1-t)B_{0}^{n-1}(t) + \sum_{i=1}^{n-1}\left((1-t)B_i^{n-1}(t) + tB_{i-1}^{n-1}(t)\right)\p_{i} + \p_n B_{n-1}^{n-1}(t). \\
        \end{align*}
        Uporabimo še rekurzivno zvezo Bernsteinovih baznih polinomov iz izreka~\ref{izrek:bernsteinovi_lastnosti:rekruzija}, da dobimo
        \begin{align*}
            \p_0B_{0}^{n}(t) + \sum_{i=1}^{n-1}\p_{i}B_i^n(t) + \p_n B_{n}^{n}(t) = \sum_{i=0}^{n}\p_{i}B_i^n(t).
        \end{align*}
    \end{dokaz}
    Označimo sedaj $\p_{i}^r(t) = \bigbbt_{[\p_i,\p_{i+1},\dots,\p_{i+r}]}$.
    Velja torej $\p_{i}^0(t)=\p_i$ in  $\p_{0}^n(t)=\bigbbt_{[\p_0,\p_1,\dots,\p_n]}$.
    Iz izreka~\ref{izrek:decastelaju-rekurzija} sledi, da lahko točke Bezierjeve krivulje $\bigbbt_{[\p_0,\p_1,\dots,\p_n]}$ računamo s pomočjo \textit{Decasteljaujeve sheme}, ki jo lahko vidimo na sliki~\ref{fig:decasteljau-scheme}.
    V shemi diagonalne puščice ponazarjajo množenje točke z vrednostjo $t$, vertikalne pa z vrednostjo $1-t$.
    V vrhu puščic dobljene vrednosti seštejemo.
    \begin{figure}[H]
        \label{fig:decasteljau-scheme}
        \begin{tabular}{ c c c c c c c c c c c}
            $\p_{0}^n(t)$     &            &                   &            &               &            &          &            &                 &            &               \\
            $\uparrow$        & $\nwarrow$ &                   &            &               &            &          &            &                 &            &               \\
            $\p_{0}^{n-1}(t)$ &            & $\p_{1}^{n-1}(t)$ &            &               &            &          &            &                 &            &               \\
            $\vdots$          & $\vdots$   & $\vdots$          & $\vdots$   & $\vdots$      &            & $\vdots$ &            &                 &            &               \\
            $\uparrow$        & $\nwarrow$ & $\uparrow$        & $\nwarrow$ & $\uparrow$    & $\nwarrow$ & $\cdots$ & $\nwarrow$ &                 &            &               \\
            $\p_{0}^1(t)$     &            & $\p_{1}^1(t)$     &            & $\p_{2}^1(t)$ &            & $\cdots$ &            & $\p_{n-1}^1(t)$ &            &               \\
            $\uparrow$        & $\nwarrow$ & $\uparrow$        & $\nwarrow$ & $\uparrow$    & $\nwarrow$ & $\cdots$ & $\nwarrow$ & $\uparrow$      & $\nwarrow$     &\\
            $\p_{0}^0(t)$     &            & $\p_{1}^0(t)$     &            & $\p_{2}^0(t)$ &            & $\cdots$ &            & $\p_{n-1}^0(t)$ &            & $\p_{n}^0(t)$
        \end{tabular}
        \caption{Decasteljaujeva shema \\ \mycomment{Najbrž bom menjal bom sliko, ko zadevo implementiram na Bezgu}}
    \end{figure}
    Izračun točke Bezierjeve krivulje pri poljubnem parametru $t$ lahko sedaj podamo v obliki \textit{Decasteljaujevega algoritma}~\ref{alg:decasteljau}.
    \begin{algorithm}[H]
        \caption{Decasteljaujev algoritem}
        \label{alg:decasteljau}
        \begin{algorithmic}
            \State $\p \gets \p_0,\p_1,\dots,\p_n$
            \State $t \gets t$
            \For{$i = 0,1,\dots n$}
                \State $\p_i^0(t)=\p_i$
            \EndFor
            \For{$r = 1,2,\dots n$}
                \For{$i=0,1,\dots,n-r$}
                    \State $\p_i^r(t)=(1-t)\p_i^{r-1}(t)+t\p_{i+1}^{r-1}(t)$
                \EndFor
            \EndFor
            \State \Return $\p_0^n(t)$
        \end{algorithmic}
    \end{algorithm}
    Algoritem~\ref{alg:decasteljau} ima tudi geometrijski pomen.
    Pri stopnji $n=1$ se prevede na interpolacijo dveh točk, kar lahko vidimo na sliki~\ref{fig:dec-alg-n1}.
    Pri višjih stopnjah $n$ pa algoritem predstavlja zaporedno interpolacijo točk, saj v njem za vsak nivo $r=1,2,\ldots,n$ interpoliramo sosednje točke prejšnjega nivoja.
    Slednje lahko vidimo na slikama~\ref{fig:dec-alg-n2} in~\ref{fig:dec-alg-n3}.
    \begin{figure}[h!]
        \captionsetup[subfigure]{labelformat=empty}
        \centering
        \subfloat[$t=0.25$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-1-t-025}}
        \qquad
        \subfloat[$t=0.5$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-1-t-05}}
        \qquad
        \subfloat[$t=0.75$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-1-t-075}}
        \qquad
        \subfloat[$t=1$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-1-t-1}}
        \caption{Decasteljaujev algoritem za $n=1$}
        \label{fig:dec-alg-n1}
    \end{figure}
    \begin{figure}[h!]
        \captionsetup[subfigure]{labelformat=empty}
        \centering
        \subfloat[$t=0.25$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-2-t-025}}
        \qquad
        \subfloat[$t=0.5$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-2-t-05}}
        \qquad
        \subfloat[$t=0.75$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-2-t-075}}
        \qquad
        \subfloat[$t=1$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-2-t-1}}
        \caption{Decasteljaujev algoritem za $n=2$}
        \label{fig:dec-alg-n2}
    \end{figure}
    \begin{figure}[h!]
        \captionsetup[subfigure]{labelformat=empty}
        \centering
        \subfloat[$t=0.25$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-3-t-025}}
        \qquad
        \subfloat[$t=0.5$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-3-t-05}}
        \qquad
        \subfloat[$t=0.75$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-3-t-075}}
        \qquad
        \subfloat[$t=1$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-3-t-1}}
        \caption{Decasteljaujev algoritem za $n=3$}
        \label{fig:dec-alg-n3}
    \end{figure}
%    \begin{figure}[h!]
%        \captionsetup[subfigure]{labelformat=empty}
%        \centering
%        \subfloat[$t=0.25$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-5-t-025}}
%        \qquad
%        \subfloat[$t=0.5$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-5-t-05}}
%        \qquad
%        \subfloat[$t=0.75$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-5-t-075}}
%        \qquad
%        \subfloat[$t=1$]{\includegraphics[width = 0.45\textwidth]{images/decasteljau-n-5-t-1}}
%        \caption{Decasteljaujev algoritem za $n=5$}
%        \label{fig:dec-alg-n5}
%    \end{figure}

    \subsection{Subdivizija}
    V CAGD in CAD sistemih se mnogokrat zgodi, da uporabnik želeli ohraniti le en kos Bezierjeve krivulje.
    Naj bo to kos krivulje, ki ga dobimo tako, da za prvotno krivuljo parameter $t$ omejimo na interval $[0,t_0]$, za neko pozitivno realno število $t_0<1$.
    Ta del krivulje označimo z $B_{t_0-}$.
    Izkaže se, da lahko krivuljo $B_{t_0-}$ podamo kot Bezierjevo krivuljo s kontrolnimi točkami $\p_0^i(t_0)$ za $i=0,1,\ldots,n$, kjer točke $\p_0^i(t_0)$ dobimo iz Decasteljaujeve sheme pri $t=t_0$.
    Podobno se izkaže tudi to, da lahko preostali kos krivulje, $B_{t_0+}$, podamo kot Bezierjevo krivuljo s kontrolnimi točkami $\p_i^i(t_0)$ za $i=0,1,\ldots,n$.
    Radovedni bralci lahko dokaz trditev najdejo v delu~\cite{placeholder}.
    Procesu deljenja krivulje na dva dela pravimo \textit{subdivizija}.
    Na sliki sheme Decasteljaujevega algoritma~\ref{fig:subdivizija} lahko vidimo, da pri določenem parametru $t_0$ točke $\p_0^0,\p_0^1,\p_0^2,\p_0^3$ tvorijo kontrolni poligon bezierjeve krivulje $B_{t_0-}$, točke $\p_0^0,\p_1^1,\p_2^2,\p_3^3$ pa kontrolni poligon krivulje $B_{t_0+}$.
    \begin{figure}[h]
        \centering
        \includegraphics[width=0.8\textwidth]{images/subdivizija}
        \caption{Decasteljaujev algoritem}
        \label{fig:subdivizija}
    \end{figure}
    Če izberimo sedaj $t_0=\frac{1}{2}$ in subdiviziramo krivuljo, dobimo dve krivulji.
    Če subdivizijo nato na dobljenih krivuljah ponavljamo, dobimo po $k$ korakih $2^k$ krivulj.
    Na sliki~\ref{fig:subdivizija-ponavljanje} si lahko ogledamo postopek za prve tri korake.
    Opazimo lahko, da so kontrolni poligoni dobljenih krivulj zmerom bližje krivulji.
    \begin{figure}[h]
        \centering
        \subfloat[Začetna krivulja s kontrolnim poligonom]{\includegraphics[width = 0.45\textwidth]{images/subdivizija-k-0}}
        \qquad
        \subfloat[$2$ krivulji, pridobljeni s subdivizijo]{\includegraphics[width = 0.45\textwidth]{images/subdivizija-k-1}}

        \subfloat[$4$ krivulje, pridobljene s subdivizijo]{\includegraphics[width = 0.45\textwidth]{images/subdivizija-k-2}}
        \qquad
        \subfloat[$8$ krivulj, pridobljenih s subdivizijo]{\includegraphics[width = 0.45\textwidth]{images/subdivizija-k-3}}
        \caption{Ponavljanje subdivizije na krivulji}
        \label{fig:subdivizija-ponavljanje}
    \end{figure}


%    \begin{dokaz}
%        \begin{align*}
%            B_{t_0}(t) = B(t_{0}t) &= \sum_{i=0}^{n}\mathbf{p}_{i}\binom{n}{i}(t_{0}t)^i(1-tt_0)^{n-i}\\
%            &= \sum_{i=0}^{n}\mathbf{p}_{i}\binom{n}{i}(t_{0}t)^i \sum_{j=0}^{n-i} \binom{n-i}{j}(-tt_0)^{j}  \\
%            &= \sum_{i=0}^{n}\mathbf{p}_{i}\binom{n}{i}(tt_0)^i \sum_{j=0}^{n-i} \binom{n-i}{j}(-t)^{j}(t_0)^{j}\\
%            &= \sum_{i=0}^{n}\mathbf{p}_{i}\binom{n}{i}(tt_0)^i \sum_{j=0}^{n-i} \binom{n-i}{j}(-t)^{j}(t_0)^{j}
%        \end{align*}
%        Želimo dobiti
%
%        \begin{align*}
%            \sum_{i=0}^{n}\p_{0}^i(t_0)\binom{n}{i}t^i(1-t)^{n-i} = \sum_{i=0}^{n}\binom{n}{i}t^i(1-t)^{n-i}  \sum_{j=0}^{n-i} \binom{n-i}{j}t_0^j(1-t_0)^{n-i-j}  \p_{j}
%        \end{align*}
%
%    \end{dokaz}

    \subsection{Ekstrapolacija}
    Ker so Bernsteinovi bazni polinomi definirani za vsa realna števila $t$, lahko krivuljo rišemo tudi izven intervala $[0,1]$.
    Recimo, da jo želimo risati na intervalu $[0,t_0]$, kjer je $t_0>$.
    Če želimo ekstrapolirano krivuljo želeli nato zapisati kot Bezierjevo krivuljo na intervalu $[0,1]$, lahko kontrolne točke ekstrapolirane krivulje pridobimo na enak način kot smo dobili kontrolne točke krivulje $B_{t_0-}$ pri subdiviziji.

    \subsection{Višanje stopnje}
    Nekateri algoritmi v CAD/CAGD sistemih za vhod potrebujejo dve Bezierjevi krivulji iste stopnje.
    Recimo, da imamo Bezierjevo krivuljo $\B$ stopnje $n$, ki jo želimo predstaviti kot Bezierjevo krivuljo stopnje $n+1$.
    Upoštevajoč $1-t+t=1$, lahko parametrizacijo krivulje $\B$ zapišemo tudi kot
    \begin{align}
        \B(t) = (1-t)\B(t)+t\B(t) = \sum_{i=0}^{n}\mathbf{p}_{i}(1-t)B_i^n(t) +\sum_{i=0}^{n}\mathbf{p}_{i}tB_i^n(t). \label{eq:visanje-param}
    \end{align}
    Če sedaj zvezi za Bernsteinove bazne polinome
    \begin{align*}
    (1-t)
        B_i^n(t) &= & \frac{n+1-i}{n+1} \binom{n+1}{i}&t^i(1-t)^{n+1-i} & &=\frac{n+1-i}{n+1}B_{i}^{n+1}(t), \\
        % &= \frac{n!}{(n-i)!i!}t^i(1-t)^{n+1-i}   &=\frac{n+1-i}{n+1}\frac{(n+1)!}{(n+1-i)!i!}t^i(1-t)^{n+1-i}
        tB_i^n(t) &= & \frac{i+1}{n+1}\frac{(n+1)!}{(n-i)!(i+1)!}&t^{i+1}(1-t)^{n+1-i-1} & &= \frac{i+1}{n+1}B_{n+1}^{n+1}(t)
        %t\binom{n}{i}t^i(1-t)^{n-i} \\
        %&= \frac{n!}{(n-i)!i!}t^{i+1}(1-t)^{n+1-i-1} \\
    \end{align*}
    vstavimo v parametrizacijo~\ref{eq:visanje-param}, dobimo
    \begin{align*}
        \B(t) &= \sum_{i=0}^{n}\mathbf{p}_{i}\frac{n+1-i}{n+1}B_{i}^{n+1}(t) +\sum_{i=0}^{n}\mathbf{p}_{i}\frac{i+1}{n+1}B_{i+1}^{n+1}(t)\\
        &= \sum_{i=0}^{n}\mathbf{p}_{i}\frac{n+1-i}{n+1}B_{i}^{n+1}(t) +\sum_{i=1}^{n+1}\mathbf{p}_{i-1}\frac{i}{n+1}B_{i}^{n+1}(t).
%&=\mathbf{p}_{0} + \sum_{i=1}^{n}\left(\mathbf{p}_{i}\frac{n+1-i}{n+1} + \mathbf{p}_{i-1}\frac{i}{n+1}\right)B_{i}^{n+1}(t)+\mathbf{p}_{n}.
    \end{align*}
    Od tod sledi, da lahko krivuljo $\B$ predstavimo kot Bezierjevo krivuljo stopnje $n+1$ s kontrolnimi točkami \[c_0=\p_0, \quad c_i=\mathbf{p}_{i}\frac{n+1-i}{n+1} + \mathbf{p}_{i-1}\frac{i}{n+1},\quad c_{n+1}=\p_n. \]
    Oglejmo si kako višanje stopnje izgleda na neki krivulji.
    Na sliki~\ref{fig:višanje} je na prvem grafu narisana Bezierjeva krivulja stopnje $3$.
    Na drugem grafu, smo stopnjo krivulje zvišali za $1$.
    Na tretjem in četrtem pa smo naredili $10$ oziroma $20$ višanj stopnje začetne krivulje.
    Krivulja je na vseh grafih enaka, imamo le več kontrolnih točk.
    Opaziti je tudi možno, da so kontrolne točke z vsakim višanjem stopnje bližje začetni krivulji, kontrolni poligon pa se zmerom bolj prilega začetni krivulji.
    \begin{figure}[h]
        \centering
        \subfloat[začetna krivulja]{\includegraphics[width = 0.45\textwidth]{images/dvig-prej}}
        \qquad
        \subfloat[eno višanje]{\includegraphics[width = 0.45\textwidth]{images/dvig-po}} \\
        \subfloat[10 višanj]{\includegraphics[width = 0.45\textwidth]{images/dvig-n}}
        \qquad
        \subfloat[20 višanj]{\includegraphics[width = 0.45\textwidth]{images/dvig-n2}}
        \caption{Višanje stopnje Bezierjeve krivulje}
        \label{fig:višanje}
    \end{figure}

    \subsection{Racionalne Bezierjeve krivulje}
    Vseh krivulj se ne moremo opisati z navadnimi Bezierjevimi krivuljami.
    Med njimi so tudi takšne, ki so za CAGD sisteme zelo pomembne, na primer izsek krožnice.
    Za opis takšnih krivulj lahko posežemo po racionalnih Bezierjevih krivuljah.
    Racionalno Bezierjevo krivuljo stopnje $n$ v $\R^d$ dobimo tako, da Bezierjevo krivuljo stopnje $n$ v $\R^{d+1}$ projiciramo na hiperravnino $w=1$.
    Točke iz $\R^{d+1}$ pri tem definiramo kot $(w,x_1,\ldots,x_n)$, projekcijo pa s predpisom $(w,\mathbf{x})\to(1,\frac{\mathbf{x}}{w})$.
    Takšna projekcija privede do naslednje definicije.
    \begin{definicija}
        \label{def:racionalna}
        Racionalna Bezierjeva krivulja stopnje $n\in\N$ je podana s kontrolnimi točkami $\p_i$ za $i=0,1,\ldots,n$ in parametrizacijo $\mathbf{R}:[0,1]\to \R^d$  določeno s predpisom \[\mathbf{R}(t) = \frac{\sum^{n}_{i=0}w_i\p_i B^n_i(t)}{\sum^{n}_{i=0}w_i B^n_i(t)},\] kjer so kontrolne točke $\p_i\in\R^d$ in uteži $w_i\in\R$.
    \end{definicija}
    Uteži so prosti parametri, ki jih lahko uporabimo pri oblikovanju.
    Kadar so vse uteži enake, je racionalna Bezierjeva krivulja enaka Bezierjevi krivulji z istimi kontrolnimi točkami.
    Da bi se izognili težavam pri deljenju z $0$ ponavadi privzamemo, da so vse uteži pozitivne.
    Vpliv uteži si poglejmo na sliki~\ref{fig:uteži}.
    Utež spreminjamo le pri rumeni točki, vse ostale uteži puščamo enake $1$.
    Na grafu (a) je utež nastavljena na število $1$, krivulja na sliki je zato navadna Bezierjeva krivulja.
    Na grafu (b) je utež nastavljena na število $2$, krivulja je zato bližje rumeni točki kakor na grafu (a).
    Na grafih (c) in (d) pa lahko vidimo, da se z višanjem uteži, krivulja še bolj bliža rumeni točki.
    \begin{figure}[h]
        \centering
        \subfloat[w=1]{\includegraphics[width = 0.45\textwidth]{images/racionalnaw1}}
        \qquad
        \subfloat[w=2]{\includegraphics[width = 0.45\textwidth]{images/racionalnaw2}}\\
        \subfloat[w=4]{\includegraphics[width = 0.45\textwidth]{images/racionalnaw3}}
        \qquad
        \subfloat[w=10]{\includegraphics[width = 0.45\textwidth]{images/racionalnaw10}}
        \caption{Vpliv uteži}
        \label{fig:uteži}
    \end{figure}
    Iz zapisa parametrizacije v definiciji~\ref{def:racionalna} lahko hitro vidimo, da množenje vseh uteži s poljubnim neničelnim številom parametrizacije krivulje ne spremeni.
    Tako lahko brez izgube splošnosti poljubno utež fiskiramo na $1$.
    Ni pa očitno to, da lahko to storimo za dve uteži.
    Poglejmo si naslednji izrek.
    \begin{izrek}
        \label{izrek:racionalne-utezi-1}
        Racionalno Bezierjevo krivuljo s pozitivnimi utežmi $w_i$ in parametrizacijo $\mathbf{R}$, lahko reparametriziramo v parametrizacijo $\mathbf{\tilde{R}}$ s pozitivnimi utežmi $\tilde{w}_i$ tako, da velja $\tilde{w}_0=\tilde{w}_{n}=1.$
    \end{izrek}
    Izrek nam pove, da smo z uvedbo racionalnih Bezierjevih krivulj dobili dobili le $n-1$ dodatnih prostih parametrov, glede na navadne Bezierjeve krivulje.
    Dokaz izreka bo konstrukcijske narave.
    Našli bomo torej uteži $\tilde{w}_i$, katere lahko zamenjamo z utežmi $w_i$, tako da ohranimo isto krivuljo.
    \begin{dokaz}
        \label{dokaz:standardna-forma}
        Uporabimo reparametrizacijsko funkcijo $\varphi(t):[0,1]\to[0,1]$ s predpisom $\varphi(t)=\frac{t}{\rho(1-t)+t}$, kjer je $\rho$ pozitivno realno število.
        Če reparametrizacijsko funkcijo vstavimo v $i$-ti Bernsteinov bazni polinom dobimo naslednje
        \begin{align*}
            B^n_i(\varphi(t)) &=  \binom{n}{i}\left(\frac{t}{\rho (1-t)+t}\right)^i\left(1-\frac{t}{\rho (1-t)+t}\right)^{n-i} \\
            B^n_i(\varphi(t)) &=  \binom{n}{i}\left(\frac{t}{\rho (1-t)+t}\right)^i\left(\frac{\rho(1-t)}{\rho (1-t)+t}\right)^{n-i} \\
            &= \binom{n}{i}\frac{\rho^{n-1}t^{i}(1-t)^{n-i}}{(\rho(1-t)+t)^n} =  \frac{\rho^{n-1}}{(\rho(1-t)+t)^n}B^n_i(t).
        \end{align*}
        Reparametrizirane Bernsteinove bazne polinome sedaj vstavimo v parametrizacijo racionalne Bezierjeve krivulje da dobimo
        \[\mathbf{R}(\varphi(t)) = \frac{\sum^{n}_{i=0}\rho^{n-i}w_i\p_i B^n_i(t)}{\sum^{n}_{i=0}\rho^{n-i}w_i B^n_i(t)}. \]
        S starimi utežmi izrazimo nove uteži $\hat{w}_i=\rho^{n-i}w_i$.
        Želimo, da bi veljalo $\hat{w}_0=\hat{w}_n$, zato nastavimo $\rho= \sqrt[n]{\frac{w_n}{w_0}}$.
        Ker velja $\hat{w}_n=w_n$ lahko uteži $\hat{w}_i$ delimo z utežjo $w_n$, da dobimo željene uteži \[\tilde{w_i}=\frac{1}{w_n}\hat{w_i} = \frac{w_i}{\sqrt[n]{w^{i}_nw_0^{n-i}}}.\]
    \end{dokaz}
    \begin{opomba}
        Če velja $w_0=w_n=1$ pravimo, da je racionalna Bezierjeva krivulja predstavljena v \textit{standardni formi}.
    \end{opomba}
    Lastnosti Bezierjevih krivulj, ki smo jih podali v izreku~\ref{izrek:lastnosti-bezierjevih-krivulj} veljajo tudi za racionalne Bezierjeve krivulje s pozitivnimi utežmi.
    Interpolacijo točk lahko dokažemo na podoben način, kakor smo to storili pri dokazu izreka~\ref{izrek:lastnosti-bezierjevih-krivulj}.
    Da dokažemo, da je racionalna Bezierjeva krivulja afino invariantna, ter da leži znotraj konveksne ovojnice svojih kontrolnih točk, pa posežemo po naslednjem zapisu.
    \[\mathbf{R}(t)=\sum^n_{i=0}\p_i N^n_i, \quad N^n_i(t)\coloneqq \frac{w_i B^n_i(t)}{\sum^n_{i=0}w_i B^n_i(t)}\]
    Če pri dokazu izreka~\ref{izrek:lastnosti-bezierjevih-krivulj} namesto Bernsteinovih polinomov $B_i^n(t)$ vstavimo funkcijo $N^n_i$ iz zgornjega zapisa, dobimo dokaz lastnosti za racionalne Bezierjeve krivulje.

    \subsubsection{Metode racionalnih Bezierjevih krivulj}
    Racionalne Bezierjeve krivulje $\in\R^d$ so projekcije Bezierjevih krivulj $\in\R^{d+1}$.
    Metode, ki smo jih predstavili na Bezierjevih krivuljah, lahko enostavno razširimo tudi na racionalne Bezierjeve krivulje.
    To storimo tako, da metode uporabimo na Bezierjevi krivulji $\in\R^{d+1}$ ter jo nato projiciramo nazaj v ravnino $\in\R^{d}$.
    Vse metode razen ekstrapolacije ohranjajo pozitivnost uteži. \mycomment{A je to res res?}

    \subsubsection{Decasteljaujev algoritem za racionalne Bezierjeve krivulje}
    Točke racionalnih Bezierjevih krivulj bi lahko računali tako, kakor smo pokazali za metode.\mycomment{<slabtekstneberi
    Takšno računanje je nestabilno*****, zato tudi tukaj podamo stabilnejši način računanja, ki je razširitev Decasteljaujevega algoritma.}
    \begin{algorithm}[h!]
        \caption{Racionalni Decasteljaujev algoritem}
        \begin{algorithmic}
            \State $\p \gets \p_0,\p_1,\dots,\p_n$
            \State $w\gets \p_0,\p_1,\dots,\p_n$
            \For{$i = 0,1,\dots n$}
                \State $\p_i^0(t)=\p_i$
                \State $w_i^0(t)=w_i$
            \EndFor
            \For{$r = 1,2,\dots n$}
                \For{$i=0,1,\dots,n-r$}
                    \State $w_i^r(t)=(1-t)w_{i}^{r-1}(t)+tw_{i+1}^{r-1}(t)$
                    \State $\p_i^r(t)=(1-t)\frac{w_{i}^{r-1}(t)}{w_{i}^{r}(t)}\p_i^{r-1}(t)+t\frac{w_{i+1}^{r-1}(t)}{w_{i}^{r}(t)}\p_{i+1}^{r-1}(t)$
                \EndFor
            \EndFor
            \State \Return $\p_0^n(t)$
        \end{algorithmic}\label{alg:racionalni-decasteljau}
    \end{algorithm}

    Dokažimo

    \subsubsection{Farinove točke}
    Ročno nastavljanje uteži z vpisovanjem, bi bilo za uporabnika CAGD sistema zamudno in nenaravno.
    Uporabniku želimo delo olajšati tako, da pridelamo bolj naraven način kontroliranja uteži.
    Izkaže se, da imajo uteži racionalne Bezierjeve krivulje geometrijski pomeni, ki ga lahko za to uporabimo.
    Uteži lahko kontroliramo s t.i. \textit{Farinovimi točkami}.
    Farinove točke ležijo na daljicah kontrolnega poligona.
    $i$-ta Farinova točka deli $i$-to daljico kontrolnega poligona v razmerju $w_{i+1}:w_{i}$.
    Slednje označimo z $\frac{|\mathbf{f}_i-\p_i|}{|\mathbf{f}_i-\p_{i+1}|} = \frac{w_{i+1}}{w_{i}}$.
    S kontrolnimi točkami in utežmi lahko Farinove točke izrazimo takole
    \[\mathbf{f}_i \coloneqq \frac{w_{i}}{w_{i}+w_{i+1}}\p_i +  \frac{w_{i+1}}{w_{i}+w_{i+1}}\p_{i+1}.\]
    Želimo pa tudi obratno – s Farinovimi točkami želimo izraziti uteži.
    Brez izgube splošnosti lahko za prvo utež izberemo $w_0=1$.
    Ostale točke lahko nato rekurzivno izračunamo s pomočjo naslednjega izraza
    \[w_{i+1} = w_i\frac{|\mathbf{f}_i-\p_i|}{|\mathbf{f}_i-\p_{i+1}|}.\]
    Po želji lahko točke nato še standardiziramo s pomočjo formule,\[\tilde{w}_{i} = \frac{w_i}{\sqrt[n]{w_n^i}},\]
    ki sledi iz dokaza~\ref{dokaz:standardna-forma}.

    Na sliki~\ref{fig:farinove-tocke} si lahko ogledamo Farinove točke v akciji.
    Uteži na sliki niso standardizirane zato, da lahko bolje vidimo razmerja med njimi.
    Na grafu (a) lahko vidimo, da $i$-ta Farinova točka leži točno na sredini med kontrolima točkama $\p_i$ in $\p_{i+1}$.
    Ker so vsa razmerja $|\p_i-\mathbf{f}_i|:|\p_{i+1}-\mathbf{f}_i|$ enaka, so vse uteži enake $1$.
    Na grafu (b) lahko vidimo, da se s premikom prve Farinove točke bližje k točki $\p_0$, k njej približa tudi krivulja.
    Utež $w_1$, ki predstavlja razmerje $|\p_0-\mathbf{f}_0|:|\p_{1}-\mathbf{f}_0|$, je zato manjša kot $1$.
    Na grafu (c) lahko vidimo premik Farinove točke bližje k točki $\p_1$.
    Krivulja se točki približa, utež $w_1$ pa se poveča na več kot $1$.
    Ker na grafoma (b) in (c) druga in tretja Farinova točka ležita na sredini svojih daljic, so uteži $w_1$,$w_2$ in $w_3$ enake.
    Na grafoma (d) in (e) lahko vidimo, kako se krivulja in uteži obnašajo ob premiku druge Farinove točke.
    Na grafoma (f) ter (g) pa lahko vidimo obnašanje, ko premaknemo prvo ter tretjo Farinovo točko hkrati gor ali dol.
    Poglejmo si še, kaj se zgodi, če vse tri točke premaknemo pomaknemo tako, da so razmerja na vseh daljicah enaka.
    Na levem grafu slike~\ref{fig:farinove-tocke-2} lahko vidimo, da krivulja izgleda kakor začetna.
    Če uteži standardiziramo, kar smo storili na desnem grafu, vidimo, da je temu res tako.
    Da bi preprečili takšno izbiro Farinovih točk, lahko po vsakem premiku Farinove točke uteži standardiziramo, ter ponovno izračunamo Farinove točke.
    \begin{figure}[ht!]
        \centering
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-0}}\\
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-leva-1}}
        \qquad
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-leva-2}}\\
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-zgornja-1}}
        \qquad
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-zgornja-2}}\\
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-obe-1}}
        \qquad
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-obe-2}}
        \caption{Kontroliranje krivulje s Farinovimi točkami}
        \label{fig:farinove-tocke}
    \end{figure}

    \begin{figure}[ht!]
        \centering
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-vsetri-0}}
        \qquad
        \subfloat[]{\includegraphics[width = 0.45\textwidth]{images/farinove-tocke-premik-vsetri-1}}
        \caption{Krivulja z enakimi premiki vseh Farinovih točk, pred in po standardizaciji}
        \label{fig:farinove-tocke-2}
    \end{figure}

    \subsubsection{Izsek krožnice}
    V uvodu podrazdelka smo povedali, da se nekaterih krivulj ne da opisati z navadnimi Bezierjevimi krivuljami.
    Kot enega izmed primerov smo podali izsek krožnice.
    V tem delu podrazdelka bomo izpeljali kontrolne točke in uteži racionalne Bezierjeve krivulje, da bo krivulja predstavljala izsek enotske krožnice s \mycomment{kotom $\alpha$}.
    Izsek krožnice bomo podali s kvadratičnimi racionalnimi Bezierjevimi krivuljami.
    Za konstrukcijo imamo na voljo kontrolne točke $\p_0,\p_1$ in $\p_2$, ter uteži $w_0,w_1$ in $w_2$.
    Iz izreka~\ref{izrek:racionalne-utezi-1} sledi, da lahko robni uteži fiksiramo na $w_0=w_2=1$.
    Točki $\p_0$ in $\p_2$ morata ležati na začetku ter koncu izseka krožnice, saj racionalne Bezierjeve krivulje interpolirajo končne točke.
    Da bo temu tako, mora veljati $\p_2=(\cos(\alpha),\sin(\alpha))$.
    Ker je krožni izsek simetričen čez premico z naklonom $\frac{\alpha}{2}$, krivulja pa parabola, lahko pričakujemo, da bo točka $\p_1$ ležala na premici med točkama $\p_0$ in $\p_2$, tj.\ $\p_1=\left(R\cos\left(\frac{\alpha}{2}\right),R\sin\left(\frac{\alpha}{2}\right)\right)$.
    Sedaj je cilj najti vrednosti $R$ in $w_1$.
    Najprej po komponentah zapišimo parametrizacijo željene krivulje
    \[\mathbf{R}(t) = \frac{\sum^{2}_{i=0}w_i\p_i B^2_i(t)}{\sum^{2}_{i=0}w_i B^2_i(t)} = \frac{\p_0 (1-t)^2 + w_1\p_1 2t(1-t) + \p_2 t^2}{(1-t)^2 + w_1 2t(1-t) + t^2},\]
    ki po komponentah izgleda takole
    \begin{align*}
        x(t) &= \frac{(1-t)^2 + w_1R\cos\left(\frac{\alpha}{2}\right) 2t(1-t) + \cos(\alpha)t^2}{(1-t)^2 + w_1 2t(1-t) + t^2} \\
        y(t) &= \frac{w_12t(1-t)R\sin\left(\frac{\alpha}{2}\right) + \sin(\alpha)t^2}{(1-t)^2 + w_1 2t(1-t) + t^2}.
    \end{align*}
    Tangenta na enotsko krožnico je v točki $(1,0)$ vzporedna z ordinatno osjo, zato mora veljati $x'(0)=0$.
    \mycomment{Odvod racionalne Bezierjeve krivulje v točki $(1,0)$ je enak $2(\p_{1}-\p_{0}) = 2\left(R\sin\left(\frac{\alpha}{2}\right)-r,R\cos\left(\frac{\alpha}{2}\right)\right)$.}
    Iz česar sledi $R=\frac{r}{\cos\left(\frac{\alpha}{2}\right)}$.
    \begin{align*}
        w_1\left(\frac{r}{\sin\left(\frac{\alpha}{2}\right)}-r\right)\sin\left(\frac{\alpha}{2}\right)  &= r\sin\left(\frac{\alpha}{2}\right) - \frac{r}{2}\sin(\alpha) \\
        w_1 &= \frac{r\sin\left(\frac{\alpha}{2}\right) - \frac{r}{2}\sin(\alpha)}{\left(\frac{r}{\sin\left(\frac{\alpha}{2}\right)}-r\right)\sin\left(\frac{\alpha}{2}\right) }
    \end{align*}


    Zaradi simetrije mora krivulja v $t=\frac{1}{2}$ interpolirati točko $\left(\cos\left(\frac{\alpha}{2}\right),\sin\left(\frac{\alpha}{2}\right)\right)$ iz česar sledi
    \begin{align*}
        x\left(\frac{1}{2}\right) &= \frac{\frac{1}{4} +  \frac{1}{2}w_1R\cos\left(\frac{\alpha}{2}\right) + \frac{1}{4}\cos(\alpha)}{\frac{1}{4}+ w_1\frac{1}{2} + \frac{1}{4}} = \frac{ \frac{1}{2} + w_1R\cos\left(\frac{\alpha}{2}\right) + \frac{1}{2}\cos(\alpha)}{1+w_1} = \cos\left(\frac{\alpha}{2}\right) \\
        y\left(\frac{1}{2}\right) &= \frac{\frac{w_1}{2}R\sin\left(\frac{\alpha}{2}\right) + \frac{1}{4}\sin(\alpha)}{\frac{1}{4}+ w_1\frac{1}{2} + \frac{1}{4}} =  \frac{w_1R\sin\left(\frac{\alpha}{2}\right) + \frac{1}{2}\sin(\alpha)}{1+w_1} = \sin\left(\frac{\alpha}{2}\right).
    \end{align*}
    Iz enačbe izpostavimo $w_1$
    \begin{align*}
        \frac{1}{2} + w_1R\cos\left(\frac{\alpha}{2}\right) + \frac{1}{2}\cos(\alpha) &= (1+w_1)\cos\left(\frac{\alpha}{2}\right) \\
        w_1R\cos\left(\frac{\alpha}{2}\right) - w_1\cos\left(\frac{\alpha}{2}\right) &= \cos\left(\frac{\alpha}{2}\right)-\frac{1}{2} - \frac{1}{2}\cos(\alpha) \\
        w_1(R-1)\cos\left(\frac{\alpha}{2}\right) &= \left(\cos\left(\frac{\alpha}{2}\right)-\frac{1}{2} - \frac{1}{2}\cos(\alpha)\right)
    \end{align*}
    NEXT
    \begin{align*}
        w_1R\sin\left(\frac{\alpha}{2}\right) + \frac{1}{2}\sin(\alpha) &= (1+w_1)\sin\left(\frac{\alpha}{2}\right) \\
        w_1(R-1)\sin\left(\frac{\alpha}{2}\right)  &= \sin\left(\frac{\alpha}{2}\right) - \frac{1}{2}\sin(\alpha)
    \end{align*}

    \begin{align*}
        \frac{r}{2} + w_1R\cos\left(\frac{\alpha}{2}\right) + \frac{r}{2}\cos(\alpha) &=(1+w_1) r\cos\left(\frac{\alpha}{2}\right) \\
        w_1R\cos\left(\frac{\alpha}{2}\right) - w_1r\cos\left(\frac{\alpha}{2}\right) &= r\cos\left(\frac{\alpha}{2}\right)-\frac{r}{2}\cos(\alpha)-\frac{r}{2} \\
        w_1(R-r)\cos\left(\frac{\alpha}{2}\right) &= r\cos\left(\frac{\alpha}{2}\right)-\frac{r}{2}\cos(\alpha)-\frac{r}{2} \\
        w_1 &=\frac{r\cos\left(\frac{\alpha}{2}\right)-\frac{r}{2}\cos(\alpha)-\frac{r}{2}}{(R-r)\cos\left(\frac{\alpha}{2}\right)}\\
        w_1 &=\frac{r\cos\left(\frac{\alpha}{2}\right)-\frac{r}{2}\cos(\alpha)-\frac{r}{2}}{(R=\frac{r}{\cos\left(\frac{\alpha}{2}\right)}-r)\cos\left(\frac{\alpha}{2}\right)}
    \end{align*}



    \begin{align*}
        w_1\left(\frac{r}{\sin\left(\frac{\alpha}{2}\right)}-r\right)\sin\left(\frac{\alpha}{2}\right)  &= r\sin\left(\frac{\alpha}{2}\right) - \frac{r}{2}\sin(\alpha) \\
        w_1 &= \frac{r\sin\left(\frac{\alpha}{2}\right) - \frac{r}{2}\sin(\alpha)}{\left(\frac{r}{\sin\left(\frac{\alpha}{2}\right)}-r\right)\sin\left(\frac{\alpha}{2}\right) }
    \end{align*}
    Izračunajmo sedaj za $r=1$ in $\alpha = \frac{\pi}{2}$. $R=\frac{1}{\cos\left(\frac{\pi}{4}\right)} = \sqrt{2}.$
    \[ w_1 = \frac{\frac{\sqrt{2}-1}{2}}{(\sqrt{2}-1)\frac{\sqrt{2}}{2}} = \frac{\sqrt{2}-1}{(\sqrt{2}-1)\sqrt{2}} = \frac{\sqrt{2}}{2} \]

    \newpage


    \section{Zlepki Bezierjevih krivulj}
    Če si ponovno ogledamo Decasteljaujev algoritem~\ref{alg:decasteljau}, lahko hitro opazimo, da je časovna kompleksnost algoritma $O(n^2)$.
    Računanje točk Bezierjevih krivulj pri visokih stopnjah $n$ je zato lahko zamudno.
    Takšne krivulje se zato v CAD sistemih izkažejo za neuporabne.
    Da bi ohranili čim večjo kontrolo krivulj s čim manj računanja, posežemo po zlepkih Bezierjevih krivulj.
    \begin{definicija}
        Zlepek krivulj  $\mathbf{S}:[a,b]\to \R^d$ stopnje $n$ nad zaporedjem stičnih točk $a=u_0 < u\_1 < \cdots < u_{m-1} < u_m = b$
        je odsekoma polinomska krivulja, za katero velja $\mathbf{S}|_{[u_{l-1},u_l]} \in \Pn^d$.
    \end{definicija}
    Želimo si tudi, da bi naši zlepki tvorili neprekinjeno krivuljo brez kolen, saj so takšne krivulje v CAGD sistemih najbolj uporabne.
    Krivulja je po definiciji na posameznih odsekih polinomska in zato tudi gladka, problem je le v stičnih točkah.
    Naj bo
    \[\mathbf{s}(u) = \begin{dcases}
                          \mathbf{s_1}(u) = \sum_{i=0}^n \p_i^{(1)}B_i^n(\frac{u-u_0}{\Delta u_0}), & u \in [u_0,u_1),  \\
                          \mathbf{s_2}(u) = \sum_{i=0}^n \p_i^{(2)}B_i^n(\frac{u-u_1}{\Delta u_1}), & u \in [u_1,u_2]
    \end{dcases}\]
    zlepek dveh Bezierjevih krivulj.
    Da bo zlepek zvezen, mora v stični točki $u_1$ veljati $\mathbf{s}_1(u_1) = \mathbf{s}_2(u_1)$ oziroma $\p_n^{(1)} = \p_0^{(2)}$.
    Takšen zlepek, si lahko ogledamo na sliki~\ref{fig:zlepek-c0}.
    Vidimo lahko, da takšen zlepek v CAGD sistemih ne bo najbolj uporaben, saj ima v stični točki koleno.
    Če želimo, da bo zlepek vsaj zvezno odvedljiv, mora veljati prejšnje, morata pa v stični točki sovpadati tudi odvoda $\mathbf{s_1}'(u_1) = \mathbf{s_2}'(u_1)$.
    Iz REFBEZIERODVOD sledi, da mora zato veljati $\p_{n}^{(1)} - \p_{n-1}^{(1)} = \p_{1}^{(2)} - \p_{0}^{(2)}$.
    Upoštevajoč $\p_n^{(1)} = \p_0^{(2)}$, lahko enačbo zapišemo tudi kot $\p_{n}^{(1)} =  \p_{0}^{(2)}  = \frac{\p_{1}^{(2)}+ \p_{n-1}^{(1)}}{2}$.
    Takšen zlepek si lahko ogledamo na sliki~\ref{fig:zlepek-c1}.
    Opaziti je možno tudi geometrijski pomen pogoja, saj stična kontrolna točka leži točno na sredini med kontrolnima točkama.
    Kaj pa, če točka ne bi bila točno na sredini?
    Izkaže se, da za to, da kolena v stični točki ne bi bilo, ne potrebujemo zvezne odvedljivosti v analitičnem pomenu, dovolj je zvezna odvedljivost v geometrijskem pomenu.
    \begin{definicija}
        \label{def:geometrijska-zveznost}
        Zlepek krivulj \[\mathbf{s}(u) = \begin{cases}
                                             \mathbf{s_1}(u), & u \in [u_0,u_1),  \\
                                             \mathbf{s_2}(u), & u \in [u_1,u_2]
        \end{cases}\] je $n$-krat geometrijsko zvezno odvedljiv, če lahko krivulji reparametriziramo v takšni parametrizaciji $\mathbf{\tilde{s}_1}$ in $\mathbf{\tilde{s}_2}$, da je zlepek krivulj
        \[\mathbf{\tilde{s}}(u) = \begin{cases}
                                      \mathbf{\tilde{s}_2}(u), & u \in [u_0,u_1),  \\
                                      \mathbf{\tilde{s}_2}(u), & u \in [u_1,u_2]
        \end{cases}\] $n$-krat zvezno odvedljiv.
    \end{definicija}
    Takšna definicija, nam ne pomaga. \mycomment{<- ne bomo tako pustili .. :D.}
    Pogoje za geometrijsko zveznost lahko prevedemo na enačbe imenovane \textit{beta pogoji}.
    Zapišimo sedaj beta pogoje za geometrijsko odvedljivost stopnje $2$.
    Zlepek iz definicije~\ref{def:geometrijska-zveznost} je
    \begin{enumerate}
        \item $G^0$, natanko tedaj, ko je zvezen v analitičnem smislu.
        \item $G^1$, natanko tedaj, ko velja (1) in obstaja realno število $\beta_1>0$, da velja $\mathbf{s_1'}(u_1) =\beta_1\mathbf{s_2}(u_1)$.
        \item $G^2$, natanko tedaj, ko velja (2) in obstaja realno število $\beta_2$, da velja $\mathbf{s_1''}(u_1) =\beta_1^2\mathbf{s_2''}(u_1) + \beta_2\mathbf{s_2''}(u_1)$.
    \end{enumerate}
    \mycomment{Bom dokazal to? Nevem..... Verjetno samo ustvarim parametrizacijo na podlagi pogoja (t-> bt) vstavim not in bo?}
    Pogoj za $G^1$ nam pogoj za zveznost \mycomment{**dodajref} spremeni v to, da mora stična točka ležati na daljici med drugima kontrolnima točkama \mycomment{nekako referencirat prave}.
    S tem, smo pridobili prosti parameter, ki ga lahko v CAGD sistemih uporabimo za dodatno kontrolo nad krivuljo.
    $G^1$ zlepek si lahko ogledamo na sliki~\ref{fig:zlepek-g1}.
    \begin{figure}[h]
        \centering
        \includegraphics[width = 0.50\textwidth]{images/zlepek-c0}
        \caption{$C^0$ zlepek dveh Bezierjevih krivulj}
        \label{fig:zlepek-c0}
    \end{figure}
    \begin{figure}[h]
        \centering
        \includegraphics[width = 0.50\textwidth]{images/zlepek-c1}
        \caption{$C^1$ zlepek dveh Bezierjevih krivulj}
        \label{fig:zlepek-c1}
    \end{figure}
    \begin{figure}[h]
        \centering
        \subfloat[$\beta_1=0.5$]{\includegraphics[width = 0.45\textwidth]{images/zlepek-g1}}
        \qquad
        \subfloat[$\beta_1=2$]{\includegraphics[width = 0.45\textwidth]{images/zlepek-g1-2}}
        \caption{Vpliv izbora $\beta_1$ pri $G^1$ zlepku}
        \label{fig:zlepek-g1}
    \end{figure}

    \subsection{Alfa parametrizacije}
    \mycomment{NE
    NE
    NE
    Tisto je bilo nekaj drugega. Te alfa parametrizacije so za zlepke!! Ma mentor je najbrz mislil, da bi ne o tem a?
    Ker to bi prislo prav, ce naredim tudi zlepke PH krivulj (kar naceloma ne bi smelo bit tako problematicno...).
    }

    \newpage


    \section{PH Krivulje}
    Motivacija: fajn so nam takšne parametrizacije, da se isto hitro premikamo po njih. (ce karkoli rises recimo)
    V poglavju se bomo osredotočili (mogoce celo samo govorili?) o krivuljah v $\R^2$.

    \subsection{Dolžina krivulje kot racionalna funkcija}
    Dolžina krivulje podane s parametrizacijo  $\mathbf{r}(t) = \left(x(t),y(t)\right)$ je definirana z enačbo $\int_0^t \sqrt {x^{'2}(t)+y^{'2}(t)}$.
    Integrandu v enačbi pravimo \textit{parametrična hitrost} krivulje, označimo ga z $\sigma(t)$.
    Idealno bi bilo, da je hitrost $\sigma(t) = 1$ za vsak $t\in [0,t_0]$, saj bi v tem primeru veljalo $s(t)=t$.
    Takšna parametrizacija je zlahka dosegljiva za črte, tudi za odseke krožnice (z rabo trigonometričnih funkcij), v splošnem pa ne.
    Dokaz da nobena krivulja ne more biti parametrizirana z racionalnimi funkcijami svoje dolzine.???

    \subsection{Polinomska parametrična hitrost}
    Kot smo zgoraj dokazali, ne moremo doseči racionalne parametrizacije krivulje, ki bi imela hitrost enako $1$.
    Če krivulje nekoliko omejimo, lahko dosežemo, da bo funkcija hitrosti vsaj polinom.
    To dosežemo tako, da zahtevamo, da je polinom $x^{'2}(t)+y^{'2}(t)$ popoln kvadrat.
    V takšnem primeru se namreč koren v integrandu izraza REFNAENACBO pokrajša, pod integralom pa ostane polinom.
    Krivuljam za katere to drži pravimo \textit{krivulje s pitagorejskimi hodografi} oziroma \textit{PH krivulje}.
    Integral polinoma je tudi polinom, iz česar sledi, da lahko dolžino PH krivulje izračunamo tako, da evalviramo polinom.
    V naslednjih razdelkih bomo videli, da nam tale lastnost omogoča več, kot samo

    \begin{definicija}
        Hodograf krivulje podane s parametrizacijo $\mathbf{r}(t)\in \R^n$ je krivulja katere parametrizacija je odvod parametrizacije prvotne krivulje.
        \mycomment{V primeru, da komponente parametrizacije hodografa krivulje tvorijo
        Krivulja podana s parametrizacijo $\mathbf{r}(t)\in \R^n$ je krivulja s pitagorejskim hodografom, če komponente hodografa tvorijo pitagorejsko $(n+1)$-terko. (???????????????? se tako rece?)}
    \end{definicija}

    Pri konstrukciji Bezierjevih PH krivulj bomo potrebovali polinome, ki tvorijo pitagorejske trojice.
    Pomagali si bomo z naslednjim izrekom.

    \begin{izrek}              % (tvorijo pitagorejsko trojico??)
        Polinomi $a,b$ in $c$ tvorijo pitagorejsko trojico, tj.\ zadoščajo enačbi
        \vspace{-0.3cm}
        \begin{align}
            a^2(t)+b^2(t)=c^2(t), \label{eq:abc}
        \end{align}
        natanko tedaj, ko obstajata tuja si polinoma $u$ in $v$ ter nek polinom  $w$ za katere velja
        \vspace{-0.3cm}
        \begin{align}
            &a(t)=[u^2(t)-v^2(t)]w(t), \nonumber \\
            &b(t)=2u(t)v(t)w(t),        \nonumber \\
            &c(t)=[u^2(t)+v^2(t)]w(t). \label{eq:uvw}
        \end{align}
    \end{izrek}

    Izrek tudi dokažimo.

    \begin{dokaz}
        \mbox{}\\
        ($\Leftarrow$) Dokaz je enostaven, saj lahko vrednosti polinomov $a$,$b$ in $c$ iz enačbe ~\eqref{eq:uvw} vstavimo v enačbo ~\eqref{eq:abc} in preverimo. \\
        ($\Rightarrow$) Najprej definiramo polinom $w(t)=\gcd(a(t),b(t),c(t))$.
        Pri tako definiranem polinomu $w$, so si polinomi $\tilde{a}(t)=\frac{a(t)}{w(t)}, \tilde{b}(t)=\frac{b(t)}{w(t)}, \tilde{c}(t)=\frac{c(t)}{w(t)}$ tuji in zadoščajo enačbi $\tilde{a}^2(t)+\tilde{b}^2(t)=\tilde{c}^2(t)$.
        Enačbo zapišemo nekoliko drugače \[\tilde{b}^2(t)= \tilde{c}^2(t)-\tilde{a}^2(t) = [\tilde{c}(t)+\tilde{a}(t)][\tilde{c}(t)-\tilde{a}(t)].\]
        Polinoma $\tilde{c}(t)+\tilde{a}(t)$ in $\tilde{c}(t)-\tilde{a}(t)$ ne moreta imeti skupnih ničel, saj bi to impliciralo skupne ničle polinomov $\tilde{a},\tilde{b},\tilde{c}$, kar bi bilo v nasprotju z njihovo definicijo.
        Ker skupnih ničel nimata, mora biti vsaka ničla polinoma $\tilde{b}$ tudi ničla sode stopnje enega izmed polinomov $\tilde{c}(t)+\tilde{a}(t)$ ali $\tilde{c}(t)-\tilde{a}(t)$.
        Tako lahko definiramo tuja si polinoma $u$ in $v$, da velja $\tilde{c}(t)+\tilde{a}(t)=2u^2(t)$ in $\tilde{c}(t)-\tilde{a}(t)=2v^2(t)$.
        Iz enačb potem hitro sledi \[\tilde{a}=u^2(t)-v^2(t),\quad\tilde{b}(t)=2u(t)v(t), \quad\tilde{c}(t)=u^2(t)+v^2(t).\]
        Če enačbe pomnožimo s polinomom $w$ dobimo željeno obliko~\eqref{eq:uvw}. \qedhere
    \end{dokaz}
    Iz konstrukcije dokaza lahko hitro vidimo, da je za pitagorejske trojice pri katerih je največji skupni delitelj konstanta, konstanten tudi polinom $w$ ter $\gcd(u(t),v(t))$.
    Takšnim trojicam pravimo \textit{primitivne pitagorejske trojice}.
    Parametrizacijo ravninske PH krivulje $\mathbf{r}(t)=(x(t),y(t))$ lahko dobimo tako, da vstavimo tuja si polinoma $u,v$ in polinom $w$ v izraza
    \begin{align}
        x'(t)=[u^2(t)-v^2(t)]w(t),\quad y'(t)=2u(t)v(t)w(t)  \label{eq:hodograf-splosni}
    \end{align} in integriramo.
    Brez izgube splošnosti lahko $x'$ oziroma $y'$ asociramo z $a$ ali $b$****** (pac kateri izraz kateremo pripopamo, ma je treba to dokazat).
    Nekateri izbori polinomov $u,v,w$ porodijo izrojene(????) krivulje, takšne izbore bi radi izločili.
    Izbori, ki porodijo izrojene krivulje so sledeči:
    \vspace{-0.3cm}
    \begin{enumerate}
        \itemsep0em
        \item $w(t)=0$ ali $u(t)=v(t)=0$, hodograf je v takšnem primeru enak $x'(t)=y'(t)=0$.
        Takšen hodograf ne definira krivulje ampak točko.
        \item  Če so polinomi $w(t),u(t),v(t)$ konstantni in ne ustrezajo točki (a), potem je konstanten tudi hodograf.
        Takšen hodograf definira enakomerno parametrizirano premo črto.
        \item  Če sta polinoma $u$ in $v$ konstantna ter vsaj en neničelen, polinom $w$ pa ni konstanten.
        Potem hodograf spet definira premo črto, a tokrat parametrizacija ni enakomerna. (hitrost ni konstanta)
        \item Enako kot v točki (c) dobimo tudi v primeru, ko je polinom $w$ neničelen in en izmed polinomov $u$ in $v$ je ničelen.
    \end{enumerate}
    \vspace{-0.3cm}
    \noindent Neizrojene PH krivulje dobimo torej pri izborih neničelnih polinomov $u,v$ in $w$, kjer vsaj en izmed polinomov $u$ in $v$ ni konstanten.

    S številom $\lambda$ označimo stopnjo polinoma $w$, s številom $\mu$ pa $\max(\deg(u(t)),\deg(v(t)))$.
    PH krivulja, pridobljena z integracijo zgornjega hodografa, je stopnje $n=\lambda + 2\mu + 1$.
    Prostih parametrov pa je manj.
    Vsak izmed polinomov $u$ in $v$ je namreč definiran z največ $\mu + 1$ parametri.
    Brez izgube splošnosti lahko vodilni koeficient polinoma $w$ fiksiramo na $1$.
    Polinom $w$ je zato definiran z $\lambda$ parametri.
    Integracijska konstanta pri integriranju hodografa nam poda še $2$ prosta parametra.
    Skupno je prostih parametrov zato $\lambda + 2(\mu+1)+2=\lambda + 2\mu+4 = n+3$.
    Kjer zadnja enakost sledi iz zgornje enačbe za stopnjo PH krivulje.
    Vseh parametrov ne moremo porabiti za obliko krivulje.
    Dva parametra nam določi izbor začetne točke, en parameter nam določi usmerjenost/rotacija/(???) krivulje, še dva nam določi izbor parametrizacije, saj substitucija $t\to at+b$ ne spremeni oblike ali stopnje krivulje.
    Ostane nam $n-2$ prostih parametrov za obliko krivulje.

    \subsection{Kontrolne točke Bezierjevih PH krivulj}
    V tem podrazdelku bomo s kontrolnimi točkami Bezierjevih krivulj karakterizirali \textit{Bezierjeve PH krivulje}, to so Bezierjeve krivulje katerih hodograf je pitagorejska trojica.
    Osredotočili se bomo na hodografe primitivnih pitagorejskih trojic.
    Takšni hodografi definirajo regularne PH krivulje, saj za njih velja $\mathbf{r}(t) \neq 0$ pri vsakem realnem številu $t$.
    Tako dobljene PH krivulje so lihe stopnje $n=2\mu+1$.

    Najbolj osnovne netrivialne PH krivulje dobimo tako, da za polinoma $u$ in $v$ izberemo Bernsteinova polinoma
    \[u(t)=u_0B_{0}^{1}(t)+u_1B_{1}^{1}(t),\quad v(t)=v_0B_{0}{1}(t)+v_1B_{1}^{1}(t)\]
    pri katerih mora veljati $u_0v_1-u_1v_0\neq 0$ in $(u_1-u_0)^2+(v_1-v_0)^2\neq 0$, da sta si polinoma $u$ in $v$ tuja, ter da vsaj en od njiju ni konstanten.
    Za polinom $w$ izberemo konstanten polinom $w(t)=1$.
    Ko polinome vstavimo v enačbo REFERENCANAENACBO, dobimo hodograf
% Realno to ni tako ocitno, bi blo fajn dejansko izpeljat!
    \begin{align*}
        x'(t) &=(u_0^2-v_0^2)B_{0}^{2}(t)+(u_0u_1-v_0v_1)B_{1}^{2}(t) + (u_1^2-v_1^2)B_{2}^{2}(t)\\
        y'(t) &= 2u_0 v_0 B_{0}^{2}(t)+(u_0v_1+u_1v_0)B_{1}^{2}(t)+2u_1 v_1 B_{2}^{2}(t).
    \end{align*}

    Hodograf sedaj integriramo tako, da uporabimo lastnost~\ref{izrek:bernsteinovi_lastnosti:integral} iz izreka~\ref{izrek:bernsteinovi_lastnosti}.
    Če upoštevamo še, da so Bernsteinovi polinomi razčlenitev enote dobimo
    \begin{align*}
        x(t) = &\ \ \ x_0(B_{0}^{3}(t) + B_{1}^{3}(t) + B_{2}^{3}(t)+ B_{3}^{3}(t)) \\
        &+ \frac{1}{3}(u_0^2-v_0^2)(B_{1}^{3}(t) + B_{2}^{3}(t)+ B_{3}^{3}(t)) \\
        &+ \frac{1}{3}(u_0u_1-v_0v_1)(B_{2}^{3}(t)+ B_{3}^{3}(t)) \\
        &+ \frac{1}{3} (u_1^2-v_1^2)B_{3}^{3}(t)\\
        y(t) = &\ \ \  y_0(B_{0}^{3}(t) + B_{1}^{3}(t) + B_{2}^{3}(t)+ B_{3}^{3}(t)) \\
        &+ \frac{1}{3}2u_0 v_0(B_{1}^{3}(t) + B_{2}^{3}(t)+ B_{3}^{3}(t)) \\
        &+ \frac{1}{3}(u_0v_1+u_1v_0)(B_{2}^{3}(t)+ B_{3}^{3}(t)) \\
        &+ \frac{1}{3} 2u_1 v_1 B_{3}^{3}(t),
    \end{align*}
    kar ustreza Bezierjevi krivulji s kontrolnimi točkami
    \begin{align}
        \p_1 &=\p_0+\frac{1}{3}(u_0^2-v_0^2,2u_0v_0), \nonumber\\
        \p_2 &= \p_1+\frac{1}{3}(u_0u_1-v_0v_1, u_0v_1+u_1v_0),\nonumber\\
        \p_3 &= \p_2 + \frac{1}{3}(u_1^2-v_1^2, 2u_1v_1) \label{eq:ph-kontrolne}
    \end{align}
    kjer je točka $\p_0=(x_0,y_0)$, $x_0$ in $y_0$ pa sta integracijski konstanti.

    Kontrolni poligoni, karakterizirani z enačbo~\eqref{eq:ph-kontrolne} imajo tudi geometrijsko interpretacijo....

    \mycomment{ Kam zdej zapeljat? Se bomo sli kompleksnih stevil ali ne? Mater tezka odlocitev.... pogledat je treba racionalne odmike in shit, ce je slucjano treba dejansko nujno zapeljat v kompleksne vode.... sej so lepe samo nocem prevec balasta.}

    Kot smo v prejšnjem razdelku povedali, ima PH krivulja $n$-te stopnje $n-2$ parametrov, ki jih definirajo obliko.
    Pri pravkar definiranih krivuljah to pomeni, da ima krivulja le en prosti parameter, ki jih definira obliko.
    Takšne krivulje so v CAD sistemih neuporabne, saj uporabniku ne nudijo dovolj kontrole.
    Če želimo podoben nivo kontrole, kakor pri kubičnih Bezierjevih krivuljah, moramo poseči po \textit{kvintičnih} Bezierjevih PH krivuljah.
    Podobno kakor prej, za polinom $w$ izberemo $w(t)=1$, za polinoma $u$ in $v$ pa izberemo Bernsteinova polinoma, le da tokrat izberemo polinoma stopnje $2$
    \[u(t)=u_0B_{0}^{2}(t)+u_1B_{1}^{2}(t)+u_2B_{2}^{2}(t),\quad v(t)=v_0B_{0}^{2}(t)+v_1B_{1}^{2}(t)+v_2B_{2}^{2}(t).\]
    Da sta si polinoma $u$ in $v$ tuja, mora tukaj veljati $(u_2 v_0 -u_0 v_2)^2 \neq 4(u_0 v_1 - u_1 v_0)(u_1 v_2-u_2v_1)$.
    Vstavimo ju v hodograf in integriramo, da dobimo Bezierjevo krivuljo z naslednjimi kontrolnimi točkami
    \begin{align}
        \p_1 &=\p_0+\frac{1}{5}(u_0^2-v_0^2,2u_0v_0), \nonumber\\
        \p_2 &= \p_1+\frac{1}{5}(u_0u_1-v_0v_1, u_0v_1+u_1v_0),\nonumber\\
        \p_3 &= \p_2 + \frac{2}{5}(u_1^2-v_1^2, 2u_1v_1) + \frac{1}{5}(u_0u_2-v_0v_2, u_0v_2+u_2v_0) \nonumber \\
        \p_4 &= \p_3+\frac{1}{5}(u_1u_2-v_1v_2, u_1v_2+u_2v_1),\nonumber\\
        \p_5 &=\p_4+\frac{1}{5}(u_2^2-v_2^2,2u_2v_2).  \label{eq:ph-kontrolne-5}
    \end{align}

    \begin{lema}
        Kvintična Bezierjeva PH krivulja, definirana s kontrolnimi točkami podanimi z izrazi~\eqref{eq:ph-kontrolne-5} ima ali dva prevoja, ali pa prevoja nima, odvisno od pozitivnosti števila \[\Delta = (u_2v_0-u_0v_2)^2 - 4(u_0v_1-u_1v_0)(u_1v_1-u_2v_1).\]
    \end{lema}

    \begin{dokaz}
        \mycomment{DRUGAČE, referenciraj se na hodograf kvintične krivulje.... Odvajaj tisto.... bedno bo, tak je lajf.}


        Ker smo za polinom $w$ izbrali konstanten polinom $w(t)=1$, velja $x'(t)=u^2(t)-v^2(t),\quad y'(t)=2u(t)v(t)$.
        Če polinoma $x'$ in $y'$ odvajamo, dobimo $x''(t) = 2(u(t)-v(t))$ in $y''(t) = 2(u'(t)v(t)+u(t)v'(t))$.
        Polinome $x',y',x''$ in $y''$ vstavimo v enačbo za ukrivljenost $k=\frac{x'y''-y'x''}{(x'^2+y'^2)^{\frac{3}{2}}}$.
        Ker je imenovalec zmeraj pozitiven, nas zanima le števec.
        \begin{align*}
            x'(t)y''(t)-y'(t)x''(t) &= 2(u^2(t)-v^2(t))(u'(t)v(t)+u(t)v'(t)) - 4u(t)v(t)(u(t)-v(t))
        \end{align*}

    \end{dokaz}

    \subsection{Parametrična hitrost in dolžina krivulje}

    Parametrična hitrost PH krivulje podane s parametrizacijo $\mathbf{r}(t)=(x(t),y(t))$ je dana s polinomom
    \[\sigma(t) = |\mathbf{r}'(t)| = \sqrt{x'^2(t)+y'^2(t)} = u^2(t)+v^2(t).\]
    Če je krivulja stopnje $n$, potem morata biti polinoma $u$ in $v$ stopnje $m=\frac{1}{2}(n-1)$.
    Zapišimo polinome $u,v$ in $\sigma$ v Bernsteinovi obliki \[u(t)=\sum_{j=0}^{m}u_j B_{j}^{m}, \quad v(t)=\sum_{j=0}^{m}v_j B_{j}^{m}, \quad \sigma(t)=\sum_{j=0}^{n-1}\sigma_j B_{j,m}\]
    S pomočjo pravila za množenje Bernsteinovih polinomov iz izreka~\ref{izrek:bernsteinovi_lastnosti}, lahko koeficiente $\sigma_j$ izrazimo s koeficienti polinomov $u$ in $v$:
    \[\sigma_j = \sum_{k=\max(0,j-m)}^{\min(m,j)} = \frac{\binom{m}{k}\binom{m}{j-k}}{\binom{n-1}{j}}(u_k u_{j-k}+v_k v_{j-k}).\]
    Pridobili smo funkcijo parametrične hitrosti PH krivulje, ki je zapisana v Bernsteinovi bazi.
    To je zelo super(enadrugabeseda dej), saj znamo vrednosti takšnih polinomov računati hitro*** in stabilno******, poleg tega pa takšen zapis dopušča enostavno integracijo v zaprte sisteme.
    Izpeljimo še funkcijo dolžine PH krivulje.
    Da pridobimo dolžino PH krivulje moramo izračunati določeni itegral polinoma hitrosti $\int_0^t\sigma(\tau)d\tau=s(t)$.
    Integral izračunamo s pomočjo integracijskega pravila iz izreka~\ref{izrek:bernsteinovi_lastnosti:mnozenje}.
    Tako dobimo dolžino PH krivulje izraženo kot polinom v Bernsteinovi bazi
    \[s(t)=\sum_{k=0}^n s_k \binom{n}{k}(1-t)^{n-k}t^k,\]
    kjer je koeficient $s_0=0$ in koeficienti $s_k = \frac{1}{n}\sum^{k-1}_{j=0}\sigma_j$.
    Iz zapisa je hitro mogoče videti, da je dolžina Bezierjeve PH krivulje enaka $s(1)=\frac{\sigma_0+\sigma_1+\cdots+\sigma_{n-1}}{n}$.
    Ker velja $\int_a^b \sigma(t)dt = \int_0^b\sigma(t)dt - \int_0^a\sigma(t)dt = s(b)-s(a)$, lahko dolžino odseka izračunamo tako, da Bernsteinov polinom $s$ evalviramo v točkah $b$ in $a$ ter vzamemo razliko.
    To je seveda spet super, ker je takšno računanje hitro in natančno (pri navadnih polinomih ponavadi uporabljamo aproksimacije).
    Lastnosti funkcije $s$ bomo v naslednjem podrazdelku uporabili tudi pri enakomerni parametrizaciji.

    \subsection{Enakomerna parametrizacija}
    MOTIVACIJA: Želimo definirati enakomerno oddaljene točke na krivulji. Takšni problemi se naravno pojavijo pri ...... \newline

    Krivuljo želimo s parametri $\{t_i\}_{i=0}^{N}$ razdeliti na $N$ kosov.
    Če to naredimo tako, da parametre $t_i$ postavimo ekvidistantno, tj. $\Delta t=t_i-t_{i-1}$ je enak za vse $i$, točke na krivulji ne bodo enako oddaljene druga od druge (glede na dolžino odseka med njima), ker parametrična hitrost krivulje $\sigma(t)$ ni konstantna.
    Slednje lahko vidimo na sliki~\ref{fig:enakomerni-t}.
    \begin{figure}[h]
        \centering
        \includegraphics[width = 0.80\textwidth]{images/enakomerni-t}
        \caption{20 točk na krivulji pri ekvidistantnih $t_i$}
        \label{fig:enakomerni-t}
    \end{figure}
    Čeprav parametrična hitrost PH krivulje niti ni konstantna, lahko njen enostaven izračun izkoristimo, da najdemo parametre $\{t_i\}^{N}_{i=0}$  za katere velja $s(t_k)=k\Delta s$, kjer je $\Delta s = \frac{s(1)}{N}$.
    Ker je parametrična hitrost $\sigma(t)=s'(t)$ pozitivna za vsa realna števila $t\in[0,1]$(ko sta u,v tuja\ldots ampak a ni da to smo mi ze privzeli prej(?) :/),
    je funkcija dolžine krivulje pri parametru $t$, $s(t)$, strogo naraščajoča.
    Parametri $t_i$ so zato enolično določeni in ležijo med $t_{i-1}$ in $1$.
    Uporabimo lahko Newton-Raphsonovo iteracijo.
    Za začetni približek vzamemo $t_k^{(0)} = t_{k-1} + \frac{\Delta s}{\sigma(t_{k-1})}$ popravljamo pa ga z iteriranjem
    \[ t_k^{(r)} = t_k^{r-1} - \frac{s(t_k^{(r-1)})}{\sigma(t_k^{(r-1)})}, \quad r=1,2,\ldots .\]
    Takšna iteracija pri začetnih približkih, ki so dovolj blizu parametra $t_k$, konvergira s kvadratično hitrostjo. (referenca na bor plestenjak? :D)
    Za večino primerov zato izračun približka $t_k$, do natančnosti reda $10^{-12}$, potrebuje le dva do tri korake iteracije.
    V praksi so takšni približki ponavadi zadovoljivi.
    Točke na PH krivulji pridobljene s takšnimi približki si lahko ogledamo na sliki~\ref{fig:enakomerni-s}.
    \begin{figure}[h]
        \centering
        \includegraphics[width = 0.80\textwidth]{images/enakomerni-s}
        \caption{20 točk na krivulji pri ekvidistantnih $t_i$}
        \label{fig:enakomerni-s}
    \end{figure}

    \subsection{Tangenta, normala in ukrivljenost}
    V prejšnjem razdelku smo pokazali, da je parametrična hitrost PH krivulje (pridobljene tocno s tistim integralom...) $\sigma$ polinom.
    V tem razdelku bomo pa pokazali, da so tangenta, normala in ukrivljenost PH krivulje racionalne funkcije.

    \begin{izrek}
        Tangenta, normala in ukrivljenost PH krivulje, glede na parameter $t$ so izražene kot racionalne funkcije
        \[\mathbf{t}=\frac{(u^2-v^2,2uv)}{\sigma}, \quad \mathbf{n}=\frac{(2uv,v^2-u^2)}{\sigma},\quad \mathbf{\kappa}=2\frac{uv'-u'v}{\sigma^2}.\]
    \end{izrek}
    Izrek tudi dokažimo.
    \begin{dokaz}
        Dokaza za tangento in normalo sta enostavna, saj hodograf REFNAHODOGRAF le vstavimo v enačbi in upoštevamo, da je polinom $\sigma = u^2+v^2$ da dobimo željeno.
        Dokažimo za ukrivljenost $\kappa$.
        V enačbo za ukrivljenost  $\kappa = \frac{x'y''-y'x''}{(x'^2+y'^2)^{3/2}}$ vstavimo hodograf REFNAHODOGRAF, ter druga odvoda $x'' = 2(uu'-vv')$ in $y'' = 2(u'v+uv')$.
        \begin{align*}
            \kappa &= 2\frac{(u^2-v^2)(u'v+uv') - 2uv(uu'-vv')}{(\sigma^2)^{3/2}}\\
            &= 2\frac{u^2vu' + u^3v' - v^3u' - v^2uv' - 2u^2vu'+2uv^2v'}{\sigma^{3}} \\
            &= 2\frac{(u^2-v^2+2v^2)uv' - (-u^2+v^2+2u^2)u'v}{\sigma^{3}} \\
            &= 2\frac{(u^2+v^2)uv' - (u^2+v^2)u'v}{\sigma^{3}} \\
            &= 2\frac{(u^2+v^2)(uv' - u'v)}{\sigma^{3}} = 2\frac{uv' - u'v}{\sigma^{2}}
        \end{align*}
    \end{dokaz}

    \subsection{Racionalne odmične krivulje}
    Odmična krivulja z razdaljo $d$ od krivulje $\mathbf{r}(t)$, je krivulja podana s parametrizacijo \[\mathbf{r}_d(t)=\mathbf{r}(t) + d\mathbf{n}(t).\]
    Takšne krivulje v splošnem niso racionalne, saj v imenovalcu enačbe za smer normale $\mathbf{n}(t)$ nastopa koren.
    V prejšnjem razdelku smo pokazali, da je smer normale $\mathbf{n}(t)$ za PH krivulje racionalna funkcija, iz česar sledi, da je tudi odmična krivulja PH krivulje racionalna funkcija.
    Še več, takšno odmično krivuljo lahko izrazimo kot racionalno Bezierjevo krivuljo s kontrolnimi točkami, ki jih lahko izrazimo s kontrolnimi točkami PH krivulje.
    Zapišimo kontrolne točke $PH$ krivulje $\mathbf{r}(t)$ v homogenih koordinatah
    \[\mathbf{P}_k = (W_k,X_k,Y_k) = (1,x_k,y_k), \quad k=0,1\ldots,n. \]
    Preme diference takšnih točk izgledajo takole
    \[\Delta\mathbf{P}_k = \mathbf{P}_{k+1}-\mathbf{P}_k = (0,\Delta x_k,\Delta y_k), \quad k=0,1,\ldots,n-1.\]
    Označimo še pravokotno smer $\Delta\mathbf{P}_k^{\perp} =  (0,\Delta y_k, -\Delta x_k)$.
    Parametrizacijo odmične krivulje lahko izrazimo kot
    \[\mathbf{r}_d(t)=\left(\frac{X(t)}{W(t)}, \frac{Y(t)}{W(t)}\right),\]
    kjer so polinomi $W,X$ in $Y$ stopnje $2n-1$, njihovi koeficienti (v Bernsteinovi bazi??)
    \[\mathbf{O}_k=(W_k,X_k,Y_k),\quad k=0,\ldots,2n-1  \]
    pa definirajo kontrolne točke odmične racionalne Bezierjeve krivulje v homogenih koordinatah.
    Homogene koordinate odmične krivulje $\mathbf{O}_k$ lahko v zaključeni obliki izrazimo s kontrolnimi točkami prvotne krivulje

    \[\mathbf{O}_k= \sum_{j=\max(0,k-n)}^{\min(n-1,k)} \frac{\binom{n-1}{j}\binom{n}{k-j} }{\binom{2n-1}{k}}(\sigma_j\mathbf{P}_{k-j} + dn\Delta \mathbf{P}_j^{\perp}),\quad k=0,\ldots,2n-1.        \]
    Za pokušino si sedaj oglejmo kako izgledajo kontrolne točke odmične krivulje kubične PH krivulje.
    \mycomment{Ostalih stopenj ne bomo razpisali, saj bomo v nadaljevanju predstavili zapis, ki bo vse to olajšal.}
    \begin{align*}
        \mathbf{O}_0 &= \sigma_0\mathbf{P}_0+3d\Delta\mathbf{P}_0^{\perp},  \\
        \mathbf{O}_1 &= \frac{1}{5} \left[ 2\sigma_1\mathbf{P}_0+ 3\sigma_0\mathbf{P}_1 + 3d(3\Delta\mathbf{P}_0^{\perp} + 2\Delta\mathbf{P}_1^{\perp})\right], \\
        \mathbf{O}_2 &= \frac{1}{10} \left[\sigma_2\mathbf{P}_0+ 6\sigma_1\mathbf{P}_1 + 3\sigma_0\mathbf{P}_2 + 3d(3\Delta\mathbf{P}_0^{\perp} + 6\Delta\mathbf{P}_1^{\perp}+\Delta\mathbf{P}_2^{\perp})\right], \\
        \mathbf{O}_3 &= \frac{1}{10} \left[3\sigma_2\mathbf{P}_1+ 6\sigma_1\mathbf{P}_2 + 3\sigma_0\mathbf{P}_3 + 3d(\Delta\mathbf{P}_0^{\perp} + 6\Delta\mathbf{P}_1^{\perp}+3\Delta\mathbf{P}_2^{\perp})\right], \\
        \mathbf{O}_4 &= \frac{1}{5} \left[3\sigma_2\mathbf{P}_2+ 2\sigma_1\mathbf{P}_3 + 3d(2\Delta\mathbf{P}_1^{\perp} + 3\Delta\mathbf{P}_2^{\perp})\right], \\
        \mathbf{O}_5 &= \sigma_2\mathbf{P}_3+3d\Delta\mathbf{P}_2^{\perp}
    \end{align*}
    \mycomment{Tukaj lahko razpišem $\mathbf{O}_k$ za kvintične in kubične PH.
    Dodam slike različnih offsetov in kontrolne poligone.
    Lahko dodam v program, da se narisejo te crtkane crte po katerih se premikajo kontrolne točke te odmične krivulje...}
    \begin{figure}[h]
        \centering
        \subfloat{\includegraphics[width = 0.45\textwidth]{images/ph-cubic-offsets}}
        \qquad
        \subfloat{\includegraphics[width = 0.45\textwidth]{images/ph-cubic-offsets-w-controlpoints}}
        \caption{Odmične krivulje (levo) skupaj z njihovimi kontrolnimi točkami (desno)}
        \label{fig:kontrolne-točke-offset}
    \end{figure}
    Na sliki~\ref{fig:kontrolne-točke-offset} lahko vidimo, da se kontrolne točke odmične krivulje v odvisnosti od razdalje premikajo po premicah.

    \newpage


    \section{Orodje za grafični prikaz konceptov}
    Vsi koncepti predstavljeni v magistrskem delu so tudi implementirani na spletni strani.
    Slikovno gradivo skozi magistrsko delo je bilo ustvarjeno s pomočjo orodja.
    Za risanje grafov sem uporabil odprtokodno knjižnico JSxGraph.
    Za oblikovanje spletne strani sem uporabil ogrodje bootstrap.
    Za ogrodje same spletne strani pa React.

    \subsection{Implementacija konceptov magistrskega dela}


    \newpage


    \section{Integrali po \texorpdfstring{$\omega$}{ω}-kompleksih}

    \subsection{Definicija}
    \begin{definicija}
        Neskončno zaporedje kompleksnih števil, označeno z $\omega = (\omega_1, \omega_2, \ldots)$,
        se imenuje \emph{$\omega$-kompleks}.\footnote{To ime je izmišljeno.}

        Črni blok zgoraj je tam namenoma. Označuje, da \LaTeX{} ni znal vrstice prelomiti pravilno
        in vas na to opozarja. Preoblikujte stavek ali mu pomagajte deliti problematično besedo z
        ukazom \verb|\hyphenation{an-ti-ko-mu-ta-ti-ven}| v preambuli.
    \end{definicija}
    \begin{trditev}[Znano ime ali avtor]
        \label{trd:obstoj-omega}
        Obstaja vsaj en $\omega$-kompleks.
    \end{trditev}
    \begin{proof}
        Naštejmo nekaj primerov:
        \begin{align}
            \omega &= (0, 0, 0,& &= \dots), \label{eq:zero-kompleks} \\
            \omega &= (1, i, & &=-1, -i, 1, \ldots), \nonumber \\
            \omega &= (0,& &= 1, 2, 3, \ldots). \nonumber \qedhere  % postavi QED na zadnjo vrstico enačbe
        \end{align}
    \end{proof}
\end{document}
